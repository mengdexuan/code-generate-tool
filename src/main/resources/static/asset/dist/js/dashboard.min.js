"use strict";var dashboard=angular.module("dashboard",["ngAnimate","ngResource","ui.router","ui.bootstrap","ui.validate","pascalprecht.translate","messager","toaster","hc.ui","hc.util"]);dashboard.config(["$controllerProvider","$compileProvider","$filterProvider","$provide",function(e,s,t,a){dashboard.controller=e.register,dashboard.filter=t.register,dashboard.factory=a.factory,dashboard.service=a.service,dashboard.constant=a.constant,dashboard.value=a.value}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"/asset/l10n/",suffix:".js"}),e.preferredLanguage("zh_CN")}]).config(["$httpProvider",function(e){function s(e,t,a){for(var n in e){var l=e[n],i=t+"."+n;angular.isObject(l)?s(l,i,a):a.push(encodeURIComponent(i)+"="+encodeURIComponent(null!==l?l:""))}}e.defaults.transformRequest=function(e){var t=[];for(var a in e){var n=e[a];angular.isObject(n)?s(n,a,t):t.push(encodeURIComponent(a)+"="+encodeURIComponent(null!==n?n:""))}return t.join("&")},e.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},e.defaults.headers.get={"X-Requested-With":"XMLHttpRequest"}}]),dashboard.controller("DashboardCtrl",["$rootScope","$scope","$translate","$window","toaster",function(e,s,t,a,n){s.dashboard={name:app.name,version:"1.3.3"},s.user=user,s.logo=app.logo,e.toaster=n,e.resourceServerUrl=app.resourceServceUrl+"/",e.staticResourceServerUrl=app.staticResourceServerUrl+"/"}]),angular.module("dashboard").run(["$rootScope","$state","$stateParams",function(e,s,t){e.$state=s,e.$stateParams=t}]).config(["$stateProvider","$urlRouterProvider",function(e,s){s.otherwise("/index"),e.state("/index",{url:"/index",templateUrl:"asset/tpl/dashboard/index.html",controller:"IndexCtrl"}).state("organization",{url:"/organization",templateUrl:"asset/tpl/dashboard/organization/organization.html"}).state("security",{url:"/security",template:'<div ui-view class="app-view fade-in-up"></div>'}).state("security.settings",{url:"/settings",templateUrl:"asset/tpl/dashboard/security/settings.html"}).state("security.loginLog",{url:"/login/log",templateUrl:"asset/tpl/dashboard/security/login_log.html"}).state("security.activity",{url:"/activity",templateUrl:"asset/tpl/dashboard/security/activity.html"}).state("security.permission",{url:"/permission",templateUrl:"asset/tpl/dashboard/security/permission.html"}).state("storage",{abstract:!0,url:"/storage",template:'<div ui-view class="app-view"></div>'}).state("storage.settings",{url:"/settings",templateUrl:"asset/tpl/dashboard/storage/settings.html"}).state("storage.list",{url:"/list",templateUrl:"asset/tpl/dashboard/storage/storages.html"}).state("app",{abstract:!0,url:"/app",template:'<div ui-view class="app-view"></div>'}).state("app.settings",{url:"/settings",templateUrl:"asset/tpl/dashboard/app/settings.html"}).state("app.mapping",{url:"/mapping",templateUrl:"asset/tpl/dashboard/app/mappings.html"}).state("sys",{abstract:!0,url:"/sys",template:'<div ui-view class="app-view"></div>'}).state("sys.cluster",{url:"/cluster",templateUrl:"asset/tpl/dashboard/system/cluster.html"}).state("sys.sso",{url:"/sso",templateUrl:"asset/tpl/dashboard/system/sso.html"}).state("sys.mail",{url:"/mail",templateUrl:"asset/tpl/dashboard/system/mail.html"}).state("sys.settings",{url:"/settings",templateUrl:"asset/tpl/dashboard/system/settings.html"}).state("sys.task",{url:"/task",templateUrl:"asset/tpl/dashboard/system/task.html"}).state("sys.monitor",{url:"/monitor",template:'<iframe src="druid" frameborder="0" width="100%" height="99%"></iframe>'})}]),dashboard.controller("SettingsCtrl",["$scope","$http","$state","toaster",function(e,s,t,a){s.get("setting/app").success(function(s){s.success?e.setting=s.setting:e.toaster.pop("error","提示","获取配置失败："+data.message)}).error(function(){e.toaster.pop("error","提示","获取配置失败："+status.statusCode)}),e.logo={operation:"选择LOGO",uploading:!1,uploadError:!1,uploadErrorText:""},e.icon={operation:"选择图标",uploading:!1,uploadError:!1,uploadErrorText:""},e.resource={logo:"",icon:""},e.save=function(){s.post("setting/app",e.setting).success(function(s,t,a,n){s.success?(e.settingForm.$setPristine(),e.settingForm.$setUntouched(),e.toaster.pop("success","提示","保存成功")):e.toaster.pop("error","提示","保存失败："+s.message)}).error(function(){e.toaster.pop("error","提示","保存设置失败："+status.statusCode)})},e.selectLogo=function(){angular.element("#logoFileInput").click()},e.selectImage=function(s){e.uploadType=s,angular.element("#imageFileInput").click()},e.uploadContext={},e.upload=function(){var s=angular.element("#imageFileInput")[0].files,t=new FormData;t.append("image",s[0]),t.append("field",e.uploadType);var a=new XMLHttpRequest;a.addEventListener("load",function(s){if(e.uploading=!1,200!=a.status)e.uploadResult={success:!1,message:"上传失败：请稍候再试，"+a.status};else{var t=angular.fromJson(a.response);if(e.uploadResult=t,t.success){e.setting[e.uploadType]=t.resource;var n=angular.element("#"+e.uploadType+"Image")[0];n.src=n.src+"?_dc="+(new Date).getTime()}else e.uploadResult.message="上传失败："+t.message}e.$apply()},!1),a.addEventListener("error",function(s){e.uploading=!1,e.uploadResult={success:!1,message:"上传失败：请稍候再试."}},!1),a.addEventListener("abort",function(){},!1),a.open("POST","/setting/app/upload"),e.uploading=!0,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(t)},e.uploadLogo=function(){var s=angular.element("#logoFileInput")[0].files,t=new FormData;t.append("logo",s[0]);var a=new XMLHttpRequest;a.addEventListener("load",function(s){if(e.logo.uploading=!1,200==a.status){var t=angular.fromJson(a.response);if(e.logo.result=t,t.success){var n=angular.element("#appLogo")[0];n.src=n.src+"?_dc="+(new Date).getTime()}else e.logo.message="上传失败："+t.message}else e.logo.result={success:!1,message:"上传失败：请稍候再试，"+a.status}},!1),a.addEventListener("error",function(s){e.logo.uploading=!1,e.logo.result={success:!1,message:"上传失败：请稍候再试."}},!1),a.addEventListener("abort",function(){},!1),a.open("POST","/setting/app/upload/logo"),e.logo.uploading=!0,a.send(t)},e.selectIcon=function(){angular.element("#iconFileInput").click()},e.uploadIcon=function(){var s=angular.element("#iconFileInput")[0].files,t=new FormData;t.append("icon",s[0]);var a=new XMLHttpRequest;a.addEventListener("load",function(s){if(e.icon.uploading=!1,e.icon.operation="选择图片",200!=a.status)return e.icon.uploadError=!0,void(e.logo.uploadErrorText="上传失败：请稍候再试，"+a.status);var t=angular.fromJson(a.response);if(t.success){e.icon.uploadError=!1,e.setting.appIcon=t.icon;var n=angular.element("#appIcon")[0];n.src=n.src+"?_dc="+(new Date).getTime()}else e.icon.uploadError=!0,e.icon.uploadErrorText="上传失败："+t.message},!1),a.addEventListener("error",function(s){e.icon.uploading=!1,e.icon.operation="选择图片",e.icon.uploadError=!0,e.icon.uploadErrorText="上传失败：请稍候再试."},!1),a.addEventListener("abort",function(){},!1),a.open("POST","/setting/app/upload/icon"),e.icon.uploading=!0,e.icon.operation="正在上传...",a.send(t)}}]),dashboard.controller("MappingConfigCtrl",["$scope","$http","Messager","$modal","toaster",function(e,s,t,a,n){function l(){e.status.loading=!0,s.get("conf/mapping").success(function(s,t,a,l){e.status.loading=!1,s.success?e.mappings=s.mappings:(e.status.loadError=!0,e.status.loadErrorText="获取文件配置列表失败："+s.message,n.pop("error","提示",s.message))}).error(function(){e.status.loading=!1,e.status.loadError=!0,e.status.loadErrorText="获取文件配置列表失败",n.pop("error","提示","加载失败："+status.statusCode)})}function i(e){a.open({templateUrl:e.tpl,controller:e.ctrl,backdrop:"static",resolve:{id:function(){return e.id}}}).result.then(function(){l()},function(){})}e.status={isopen:!1,loading:!1},l(),s.get("conf/category").success(function(s){e.categories=s,e.categories.splice(0,0,{name:"全部",value:""})}),e.clearSelected=function(){e.selected&&(e.selected.selected=!1,e.selected=null)},e.setSelected=function(s){e.selected&&e.selected!=s&&(e.selected.selected=!1),!0!==s.selected?(s.selected=!0,e.selected=s):(s.selected=!1,e.selected=null)},e.remove=function(){if(e.selected){t.confirm("提示","确定要删除?").then(function(t){s.post("conf/mapping/delete",{id:e.selected.id}).success(function(s,t,a,n){s.success?l():e.toaster.pop("error","提示","刪除失败："+s.message)}).error(function(s){e.toaster.pop("error","提示","刪除失败，稍候再试")})})}},e.edit=function(){e.selected&&i({tpl:"asset/tpl/dashboard/app/mapping_form.html",ctrl:"MappingConfigFormCtrl",id:e.selected.id})},e.add=function(){i({tpl:"asset/tpl/dashboard/app/mapping_form.html",ctrl:"MappingConfigFormCtrl"})},e.condition={extensions:"",category:void 0},e.search=function(s){if(0==e.condition.extensions.length&&!e.condition.category)return!0;var t=!1;if(e.condition.extensions.length>0)for(var a=e.condition.extensions.split(","),n=a.length,l=0;l<n;l++)a[l].length>0&&s.extensions.indexOf(a[l])>=0&&(t=!0);else t=!0;return(!e.condition.category||s.category==e.condition.category)&&t}}]),dashboard.controller("MappingConfigFormCtrl",["$scope","$http","id","$modalInstance","Messager",function(e,s,t,a,n){e.icon={operation:"选择图标",uploading:!1,uploadError:!1,uploadErrorText:""},s.get("conf/category").success(function(s){e.categories=s}),e.mapping={},e.operation="添加",null!=t&&(s.get("conf/mapping/"+t).success(function(s){e.mapping=s.mapping}),e.operation="编辑"),e.selectIcon=function(){$("#iconFileInput").click()},e.save=function(){var n="conf/mapping/save";null!=t&&(n="conf/mapping/update"),s.post(n,e.mapping).success(function(s){s.success?a.close():e.result=s}).error(function(s,t){e.result={success:!1,message:"保存失败:"+t}})},e.uploadIcon=function(){var s=angular.element("#iconFileInput")[0].files,t=new FormData;t.append("icon",s[0]),e.mapping.icon&&t.append("name",e.mapping.icon);var a=new XMLHttpRequest;a.addEventListener("load",function(s){if(e.icon.uploading=!1,e.icon.operation="选择图片",200!=a.status)return e.icon.uploadError=!0,void(e.icon.uploadErrorText="上传失败：请稍候再试，"+a.status);var t=angular.fromJson(a.response);if(t.success){e.icon.uploadError=!1,e.mapping.icon=t.icon;var n=angular.element("#mappingIcon")[0];n.src=n.src+"?_dc="+(new Date).getTime(),e.mappingConfigForm.$dirty=!0}else e.icon.uploadError=!0,e.icon.uploadErrorText="上传失败："+t.message;e.$apply()},!1),a.addEventListener("error",function(s){e.icon.uploading=!1,e.icon.operation="选择图片",e.icon.uploadError=!0,e.icon.uploadErrorText="上传失败：请稍候再试.",e.$apply()},!1),a.addEventListener("abort",function(){},!1),a.open("POST","/conf/mapping/upload/icon"),e.icon.uploading=!0,e.icon.uploadError=!1,e.icon.operation="正在上传...",e.$apply(),a.send(t)},e.cancel=function(){e.mappingConfigForm.$dirty?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),angular.module("lc.atwho",[]).directive("lcAtwho",["$parse","$filter","emojis","$rootScope","bus","$translate","lcData","LinkModuleService","$http","$q",function(e,s,t,a,n,l,i,o,r,c){return{require:"^ngModel",scope:!0,link:function(i,r,c){var d=e(c.atwhoKeydown),p={emojis:!0,member:!0,channel:!0,entity:!0};c.lcAtwho&&(p=$.extend(p,i.$eval(c.lcAtwho))),p.emojis&&r.atwho({at:":",data:t,show_the_at:!0,tpl:"<li data-value=':${name}:'><img width='24' height='24' src='"+appGlobal.config.cdnRoot+"image/emoji/${name}.png' class='emoji' /> ${name}</li>",callbacks:{keydown:function(e,s){d&&!s&&i.$apply(function(){d(i,{$event:e})})}}}),p.entity&&o.bindAtWho(r,c.channels&&p.channel),c.atwhoMembers&&p.member&&i.$watch(c.atwhoMembers,function(e,t){var i=_.reject(e,function(e){return e.uid===a.global.me.uid});if(i=n.member.filterBot(i,!0),_.isEmpty(i))r.atwho({at:"@",data:[]});else{_.forEach(i,function(e){0===e.state?e.lc_state='<span class="fa fa-circle lc-state offline"></span>':1===e.state?e.lc_state='<span class="fa fa-circle lc-state online"></span>':2===e.state?e.lc_state='<span class="fa fa-minus-circle lc-state busy"></span>':3===e.state&&(e.lc_state='<span class="fa fa-dot-circle-o lc-state away"></span>')}),c.hasGroup&&i.push({name:"group",display_name:l.instant("atwho.GROUP"),display_name_pinyin:"all"});var o=["<li data-value='@${name} '>","<div title='${display_name}' class='lc-avatar lc-avatar-30'>","<span class='lc-avatar-def m-l-10 m-r-5' style='background-color:${bgColor};'><div>${shortName}</div></span></div>&nbsp;","${display_name}"," <small>(${name})</small>","</li>"].join(""),d='<li data-value="@${display_name} " title="@${display_name}" class="channel">@${display_name} <small>('+l.instant("atwho.NOTICE_ALL")+")</small></li>";r.atwho({at:"@",limit:1e4,header_tpl:'<div class="header">'+l.instant("atwho.MEMBER")+"<small>↑&nbsp;↓&nbsp;"+l.instant("atwho.NAVIGATION")+"</small></div>",data:i,tpl:["<li data-value='@${name} '>","<a href title='${display_name}' class='lc-avatar lc-avatar-30'>","<img src='"+appGlobal.config.box.avatarUrl+"${avatar}' class='m-l-10'/></a>&nbsp; ","${display_name}"," <small>(${name})</small>","</li>"].join(""),search_key:"display_name",callbacks:{filter:function(e,s,t){if(_.isEmpty(e))return s;if(_.isEmpty(s))return s;var a=e.toLowerCase();return _.filter(s,function(e){return e.display_name.toLowerCase().indexOf(a)>-1||e.display_name_pinyin.toLowerCase().indexOf(a)>-1||e.name.toLowerCase().indexOf(a)>-1})},sorter:function(e,s,t){return s},tpl_eval:function(e,t){var a=null;if("group"===t.name)a=d.replace(/\$\{([^\}]*)\}/g,function(e,s,a){return t[s]});else if(t.avatar&&"default_avatar.png"!=t.avatar&&"default.png"!=t.avatar)a=e.replace(/\$\{([^\}]*)\}/g,function(e,s,a){return e.indexOf("avatar")>0?t[s].replace(".","_40x40."):t[s]});else{var n=t.display_name.substring(0,1).toLocaleUpperCase();t.firstText=n,t.shortName=s("avatarShortName")(t.display_name),t.bgColor=s("avatarBgColor")(t.display_name)["background-color"],a=o.replace(/\$\{([^\}]*)\}/g,function(e,s,a){return t[s]})}return a}}})}},!0),c.channels&&p.channel&&i.$watch(c.channels,function(e){return _.isEmpty(e)?void r.atwho({at:"#g:",data:[]}):void r.atwho({at:"#g:",limit:1e4,data:e,tpl:'<li data-value="#${name} " title="#${name}" class="channel"><i class="lcfont lc-link-group"></i>${name}</li>',header_tpl:"<div class='header'>"+l.instant("atwho.GROUP")+"<small>↑&nbsp;↓&nbsp;"+l.instant("atwho.NAVIGATION")+"</small></div>",callbacks:{filter:function(e,s,t){return _.isEmpty(e)?s:_.isEmpty(s)?s:_.filter(s,function(s){return s.name_pinyin.toLowerCase().indexOf(e.toLowerCase())>-1||s.name.toLowerCase().indexOf(e.toLowerCase())>-1})},sorter:function(e,s,t){return s}}})},!0)}}}]).directive("lcCommand",["lcData","$translate","MessageDataContext",function(e,s,t){return{require:"^ngModel",link:function(a,n,l){a.$watch(l.lcCommand,function(e,t){var a=_.sortBy(e,function(e){return e.name});a=_.filter(a,function(e){return!e.service_id||e.service_id&&e.show_in_list});var l="<li data-value='${name}' class='command'>${name} ${usage_hint} <span class='desc'>"+s.instant("atwho.CUSTOM")+"${desc}</span></li>";n.atwho({at:"/",data:a,show_the_at:!0,limit:1e4,tpl:"<li data-value='${name}' class='command'>${name} ${usage_hint} <span class='desc'>${desc}</li>",header_tpl:"<div class='header'>"+s.instant("atwho.COMMAND")+"<small>↑&nbsp;↓&nbsp;"+s.instant("atwho.NAVIGATION")+"</small></div>",callbacks:{matcher:function(e,s){var t,a;return e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e="(?:^|\\s)"+e,a=new RegExp(e+"([A-Za-z0-9_+-.]*)$|"+e+"([^-ÿ]*)$","gi"),t=a.exec(s),t?t[2]||t[1]:null},filter:function(e,s){return _.isEmpty(e)?s:_.isEmpty(s)?s:_.filter(s,function(s){var t=s.usage_hint.toLowerCase();return s.name.toLowerCase(),t.indexOf(e.toLowerCase())>-1||s.name.toLowerCase().indexOf(e.toLowerCase())>-1})},tpl_eval:function(e,s){return(s.desc&&!s.type?l:e).replace(/\$\{([^\}]*)\}/g,function(e,t,a){return s[t]})},sorter:function(e,s,t){return s}}})},!0),a.$on("$addCommand",function(s,a){a.isShow?e.integration.getCommand(a.service_id).success(function(e){if(_.find(t.data.commands,function(e){return e.service_id==a.service_id}))for(var s=0;s<t.data.commands.length;s++)t.data.commands[s].service_id===e.data.service_id&&(t.data.commands[s]=e.data);else t.data.commands.push(e.data)}).error(function(e){}):_.remove(t.data.commands,function(e){return e.service_id==a.service_id})})}}}]),dashboard.controller("IndexCtrl",["$scope","$http","$state","toaster",function(e,s,t,a){e.report={sumOfSize:"-",countOfFile:"-"},s.get("/statictis/report").success(function(s){s.success?e.report=s.report:a.error("获取报表数据失败")}).error(function(){a.error("获取报表数据失败")})}]),dashboard.controller("OrganizationCtrl",["$scope","$http","Messager","$modal",function(e,s,t,a){function n(e){angular.element("#departmentMenu").hide()}e.tree={},e.status={},e.onSelectionChange=function(s){e.current=s,e.loadUser()},e.onTreeInit=function(){var s=e.tree.getRoot();e.tree.select(s.children[0])},e.onTreeOptionClick=function(s,t){t.stopPropagation();var a=angular.element("#departmentMenu");a.css({top:t.pageY,left:t.pageX}),a.show(),e.selected=s},$(window).on("click",function(e){n(e)}),e.$on("$destroy",function(){$(window).unbind("click",n)}),e.addDepartment=function(){var s=e.selected;e.open({tpl:"asset/tpl/dashboard/organization/department_form.html",ctrl:"DepartmentCtrl",data:{parent:s},success:function(){e.tree.reload(s)}})},e.editDepartment=function(){var s=e.selected;e.open({tpl:"asset/tpl/dashboard/organization/department_form.html",ctrl:"DepartmentCtrl",data:{id:s.id},success:function(s){e.tree.get(s.id).name=s.name}})},e.moveDepartment=function(){var s=e.selected;e.open({tpl:"asset/tpl/dashboard/organization/department_move.html",ctrl:"DepartmentMoveCtrl",data:{id:s.id},success:function(s){var t=e.tree.get(s.oldParent.id);e.tree.reload(t);var a=e.tree.get(s.newParent.id);e.tree.reload(a)}})},e.deleteDepartment=function(){var a=e.selected;t.confirm("提示","确定要删除?").then(function(t){s.post("/organization/department/delete",{id:a.id}).success(function(s,t,n,l){s.success?e.tree.remove(a):e.toaster.error("刪除失败："+s.message)}).error(function(s){e.toaster.error("刪除失败，稍候再试")})})},e.loadUser=function(){e.status.loading=!0,e.$broadcast("beforeLoadUsers"),e.users=null,s.get("/organization/user/list",{params:{departmentId:e.current.id}}).success(function(s,t,a,n){e.status.loading=!1,s.success?e.users=s.users:e.status.error="获取用户列表失败："+s.message}).error(function(s,t){e.status.loading=!1,e.status.error="获取用户列表失败："+(s.message||t)})},e.open=function(e){a.open({templateUrl:e.tpl,controller:e.ctrl,backdrop:"static",resolve:{data:function(){return e.data}}}).result.then(function(s){angular.isFunction(e.success)&&e.success(s)},function(){})}}]),dashboard.controller("UserCtrl",["$scope","$http","Messager","$modal",function(e,s,t,a){e.$on("beforeLoadUsers",function(){e.selected=null}),e.select=function(s){e.selected&&e.selected!=s&&(e.selected.selected=!1),!0!==s.selected?(s.selected=!0,e.selected=s):(s.selected=!1,e.selected=null)},e.addUser=function(){e.open({tpl:"asset/tpl/dashboard/organization/user_form.html",ctrl:"UserFormCtrl",data:{department:e.current},success:function(){e.loadUser()}})},e.operation=function(t,a,n){n.stopPropagation(),a.executing=!0;var l="/organization/user/"+t,i=e.toaster.wait("正在执行...");s.post(l,{id:a.id}).success(function(e){a.executing=!1,e.success?(i.doSuccess("操作成功"),a.status=e.status):i.doError("操作失败："+e.message)}).error(function(e,s){a.executing=!1,i.doError("操作失败："+(e.message||s))})},e.reset=function(a){t.confirm("提示","确定将该用户的密码重置为系统默认密码?").then(function(){var t=e.selected;t.executing=!0;var a=e.toaster.wait("正在重置密码...");s.post("/organization/user/reset",{id:t.id}).success(function(e){t.executing=!1,e.success?a.doSuccess("重置密码成功"):a.doError("重置密码失败："+e.message)}).error(function(e,s,n,l,i){t.executing=!1,a.doError("重置密码失败："+(e.message||s))})})},e.disable=function(s,a){t.confirm("提示","确定禁用该用户?").then(function(){e.operation("disable",s,a)})},e.enable=function(s,a){t.confirm("提示","确定启用该用户?").then(function(){e.operation("enable",s,a)})},e.lock=function(s,a){t.confirm("提示","确定锁定该用户?").then(function(){e.operation("lock",s,a)})},e.unlock=function(s,a){t.confirm("提示","确定解锁该用户?").then(function(){e.operation("unlock",s,a)})},e.move=function(){e.selected;e.open({tpl:"asset/tpl/dashboard/organization/user_move.html",ctrl:"UserMoveCtrl",data:{user:e.selected,department:e.current},success:function(s){e.toaster.pop("success","移动部门成功"),e.loadUser()}})},e.setQuota=function(){e.selected;e.open({tpl:"asset/tpl/dashboard/organization/user_quota.html",ctrl:"UserQuotaCtrl",data:{user:e.selected},success:function(s){e.toaster.pop("success","调整配额成功")}})},e.transfer=function(){e.selected;e.open({tpl:"asset/tpl/dashboard/organization/user_transfer.html",ctrl:"UserTransferCtrl",data:{user:e.selected},success:function(e){}})},e.transferAdmin=function(a){e.selected.id!=e.user.id?t.confirm("提示","管理员权限移交后将会自动退出。确定要移交管理员权限？").then(function(){if(e.selected){var a={id:e.selected.id},n=e.toaster.wait("正在移交权限...");e.saving=!0,s.post("/organization/user/admin/transfer",a).success(function(s){e.saving=!1,s.success?(n.doClose(),t.alert("提示","权限移交成功").then(function(){window.location.href="/logout"})):n.doError("权限移交失败："+s.message)}).error(function(s,t){e.saving=!1,n.doError("权限移交失败："+(s.message||t))})}}):t.alert("提示","不能移交给自己")},e.editUser=function(){var s=e.selected;e.open({tpl:"asset/tpl/dashboard/organization/user_form.html",ctrl:"UserFormCtrl",data:{id:s.id},success:function(s){e.loadUser()}})}}]),dashboard.controller("DepartmentCtrl",["$scope","$http","data","$modalInstance","Messager",function(e,s,t,a,n){e.showResult=!1,e.operation="添加",e.department={},null!=t.id?(s.get("/organization/department/get/"+t.id).success(function(s){e.department=s.department,e.department.parent||delete e.department.parent}),e.operation="编辑"):e.department={parent:{id:t.parent.id,name:t.parent.name}},e.save=function(){var t="/organization/department/save";e.department.id&&(t="/organization/department/update"),s.post(t,e.department).success(function(s){s.success?a.close(e.department):e.result=s}).error(function(s,t,a,n,l){e.result={success:!1,message:"保存失败:"+t}})},e.cancel=function(){e.departmentForm.$dirty?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),dashboard.controller("UserFormCtrl",["$scope","$http","data","$modalInstance","Messager",function(e,s,t,a,n){e.operation="添加",null!=t.id?(s.get("/organization/user/get/"+t.id).success(function(s){e.user=s.user,e.user.department||delete e.user.department}),e.operation="编辑"):e.user={department:{id:t.department.id,name:t.department.name}},e.save=function(){e.saving=!0;var t="/organization/user/save";e.user.id&&(t="/organization/user/update"),s.post(t,e.user).success(function(s){e.saving=!1,s.success?a.close(e.user):e.result=s}).error(function(s,t,a,n,l){e.saving=!1,e.result={success:!1,message:"保存失败:"+t}})},e.cancel=function(){e.userForm.$dirty?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),dashboard.controller("DepartmentMoveCtrl",["$scope","$http","data","$modalInstance","Messager",function(e,s,t,a,n){e.operation="移动",e.invalid=!1,e.changed=!1,e.treeConfig={"load-url":"/organization/department/list","load-asyn":!0,"open-folder-icon":"fa fa-users","folder-icon":"fa fa-users","leaf-icon":"fa fa-users"},e.department={},null!=t.id&&s.get("/organization/department/get/"+t.id).success(function(s){e.department=s.department,e.newParent=s.department.parent}),e.onChange=function(s){e.changed=!0;var t=e.department.id;console.log(s),s.path.indexOf(t)>=0?e.invalid=!0:e.invalid=!1},e.save=function(){s.post("/organization/department/move",{id:e.department.id,parentId:e.newParent.id}).success(function(s){s.success?a.close({oldParent:e.department.parent,newParent:e.newParent}):e.result=s}).error(function(s,t,a,n,l){e.result={success:!1,message:"保存失败:"+t}})},e.cancel=function(){e.changed?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),dashboard.controller("UserMoveCtrl",["$scope","$http","data","$modalInstance","Messager",function(e,s,t,a,n){e.operation="移动",e.treeConfig={"load-url":"/organization/department/list","load-asyn":!0,"open-folder-icon":"fa fa-users","folder-icon":"fa fa-users","leaf-icon":"fa fa-users"},e.user=t.user,e.department=t.department,e.onChange=function(s){e.changed=!0},e.save=function(){s.post("/organization/user/move",{id:e.user.id,departmentId:e.department.id}).success(function(s){s.success?a.close():e.result=s}).error(function(s,t,a,n,l){e.result={success:!1,message:"保存失败:"+t}})},e.cancel=function(){e.changed?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),dashboard.controller("UserQuotaCtrl",["$scope","$http","data","$modalInstance","Messager",function(e,s,t,a,n){e.user=t.user,e.save=function(){e.saving=!0,s.post("/organization/user/set/quota",{id:e.user.id,quota:e.user.quota}).success(function(s){e.saving=!1,s.success?a.close():e.result=s}).error(function(s,t,a,n,l){e.saving=!1,e.result={success:!1,message:"保存失败:"+(s.message||t)}})},e.cancel=function(){e.userQutaoForm.$dirty?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),dashboard.controller("UserTransferCtrl",["$rootScope","$scope","$http","$modal","$modalInstance","data","Messager",function(e,s,t,a,n,l,i){s.loading=!1,s.tree={},s.user=l.user,s.onTreeInit=function(){var e=s.tree.getRoot();s.tree.select(e)},s.clear=function(){s.searching=!1,s.condition=null},s.select=function(e){s.selected=e},s.search=function(){s.condition&&(s.searching=!0,s.loading=!0,t.get("/organization/user/search",{params:{condition:s.condition}}).success(function(e,t,a,n){s.loading=!1,e.success?s.result=e.users:s.toaster.pop("error","提示",e.message)}).error(function(e,t){s.loading=!1,s.toaster.pop("error","提示","加载失败："+t)}))},s.transfer=function(e){s.select(e),!s.selected.id==s.user.id&&s.ok()},s.ok=function(){i.confirm("提示","文档移交后不可恢复，请慎重操作。确定要进行文档？").then(function(){if(s.selected){var e={source:s.user.id,target:s.selected.id},a=s.toaster.wait("正在移交文档...");s.saving=!0,t.post("/fs/transfer",e).success(function(e){s.saving=!1,e.success?(a.doSuccess("文档移交成功"),n.close()):a.doError("文档移交失败："+e.message)}).error(function(e,t){s.saving=!1,a.doError("文档移交失败："+(e.message||t))})}})},s.loadUser=function(e){s.loading=!0,t.get("/organization/user/list",{params:{departmentId:e.id}}).success(function(e,t,a,n){s.loading=!1,e.success?s.users=e.users:s.toaster.pop("error",e.message)}).error(function(e,t){s.loading=!1,s.toaster.pop("error","加载失败："+t)})},s.close=function(){n.dismiss("cancel")}}]),dashboard.controller("UserTransferAdminCtrl",["$rootScope","$scope","$http","$modal","$modalInstance","Messager",function(e,s,t,a,n,l){s.loading=!1,s.tree={},s.onTreeInit=function(){var e=s.tree.getRoot();s.tree.select(e)},s.clear=function(){s.searching=!1,s.condition=null},s.select=function(e){s.selected=e},s.search=function(){s.condition&&(s.searching=!0,s.loading=!0,t.get("/organization/user/search",{params:{condition:s.condition}}).success(function(e,t,a,n){s.loading=!1,e.success?(l.alert("提示","您的管理权限已移交").then(function(){window.location.href="/login"}),s.result=e.users):s.toaster.pop("error","提示",e.message)}).error(function(e,t){s.loading=!1,s.toaster.pop("error","提示","加载失败："+t)}))},s.transfer=function(e){s.select(e),!s.selected.id==s.user.id&&s.ok()},s.ok=function(){l.confirm("提示","管理员权限移交后将会自动退出。确定要移交管理员权限？").then(function(){if(s.selected){var e={source:s.user.id,target:s.selected.id},a=s.toaster.wait("正在移交权限...");s.saving=!0,t.post("/organization/user/transfer/admin",e).success(function(e){s.saving=!1,e.success?(a.doSuccess("权限移交成功"),n.close()):a.doError("权限移交失败："+e.message)}).error(function(e,t){s.saving=!1,a.doError("权限移交失败："+(e.message||t))})}})},s.loadUser=function(e){s.loading=!0,t.get("/organization/user/list",{params:{departmentId:e.id}}).success(function(e,t,a,n){s.loading=!1,e.success?s.users=e.users:s.toaster.pop("error",e.message)}).error(function(e,t){s.loading=!1,s.toaster.pop("error","加载失败："+t)})},s.close=function(){n.dismiss("cancel")}}]),dashboard.controller("SecuritySettingCtrl",["$scope","$http","$state","$rootScope",function(e,s,t,a){function n(){s.get("setting/security").success(function(e,s,t,n){e.success?l(e.setting):a.toaster.pop("error","提示","加载安全配置失败："+e.message)}).error(function(){a.toaster.pop("error","提示","加载安全配置失败："+status.statusCode)})}function l(s){s.watermarkProperties&&Object.keys(e.watermarkProperties).forEach(function(t){s.watermarkProperties.indexOf(t)>=0&&(e.watermarkProperties[t]=!0)}),e.setting=s}e.watermarkProperties={name:!1,dept:!1,date:!1,time:!1,fileName:!1},n(),e.reset=function(){e.securitySettingForm.$setPristine(),e.securitySettingForm.$setUntouched(),n()},e.save=function(){e.setting.watermarkProperties="",Object.keys(e.watermarkProperties).forEach(function(s){1==e.watermarkProperties[s]&&(e.setting.watermarkProperties+=s+";")}),s.post("setting/security",e.setting).success(function(s,t,n,l){s.success?(e.securitySettingForm.$setPristine(),e.securitySettingForm.$setUntouched(),a.toaster.pop("success","提示","保存成功")):a.toaster.pop("error","提示","保存失败："+s.message)}).error(function(){a.toaster.pop("error","提示","保存设置失败："+status.statusCode)})}}]),dashboard.controller("LoginLogCtrl",["$scope","$http","$state",function(e,s,t){e.load=function(){e.loading=!0,e.error=null,e.result=null,s.get("/login/log",{params:e.buildParam()}).success(function(s){e.loading=!1,!1===s.success&&(e.error=s.message),e.result=s,e.pagination.pages=Math.ceil(s.total/e.pagination.size)}).error(function(s,t){e.loading=!1,e.error=s.message||t})},e.reload=function(){e.pagination.page=1,e.load()},e.loadPage=function(s){e.pagination.page=s,e.load()},e.result={rows:[]},e.pagination={size:20,page:1,pages:0},e.onPageChange=function(){e.pagination.page>e.pagination.pages||e.reload()},e.condition={start:null,end:null,username:null,name:null},e.buildParam=function(){var s=e.condition.start,t=e.condition.end;return{size:e.pagination.size,page:e.pagination.page,start:s?moment(s).format("YYYY-MM-DD")+" 00:00:00":null,end:t?moment(t).format("YYYY-MM-DD")+" 23:59:59":null,username:e.condition.username,name:e.condition.name}},e.load()}]),dashboard.controller("ActivityCtrl",["$scope","$http","$state","$element",function(e,s,t){e.load=function(){e.loading=!0,e.error=null,e.result=null,s.get("/activity/list",{params:e.buildParam()}).success(function(s){e.loading=!1,!1===s.success&&(e.error=s.message),e.result=s,e.pagination.pages=Math.ceil(s.total/e.pagination.size)}).error(function(s,t){e.loading=!1,e.error=s.message||t})},e.reload=function(){e.pagination.page=1,e.load()},e.loadPage=function(s){e.pagination.page=s,e.load()},e.result={rows:[]},e.pagination={size:20,page:1,pages:0},e.format=function(e){if(e.indexOf(":")<0)return e;vlaue.split(":");return"<a href='/fs' target='_blank'></a>"},e.onPageChange=function(){e.pagination.page>e.pagination.pages||e.reload()},e.condition={start:null,end:null,operator:null,fileName:null,operation:null},e.buildParam=function(){var s=e.condition.start,t=e.condition.end;return{size:e.pagination.size,page:e.pagination.page,start:s?moment(s).format("YYYY-MM-DD")+" 00:00:00":null,end:t?moment(t).format("YYYY-MM-DD")+" 23:59:59":null,operator:e.condition.operator,fileName:e.condition.fileName,operation:e.condition.operation}},e.load()}]),dashboard.controller("PermissionConfigCtrl",["$scope","$http","Messager","$modal","toaster",function(e,s,t,a,n){function l(){e.loading=!0,s.get("conf/permission").success(function(s,t,a,n){e.loading=!1,s.success?e.permissions=s.permissions:e.error=s.message}).error(function(s,t){e.loading=!1,e.error=s.message||t})}function i(e){a.open({templateUrl:e.tpl,controller:e.ctrl,backdrop:"static",resolve:{permission:function(){return e.permission}}}).result.then(function(){l()},function(){})}l(),e.remove=function(a){t.confirm("提示","删除之后已配置的文件权限将会失效，确定要删除?").then(function(t){var n=e.toaster.wait("正在删除...");s.post("conf/permission/delete",{id:a.id}).success(function(e,s,t,a){e.success?(n.doSuccess("权限配置已删除"),l()):n.doError("删除失败："+e.message)}).error(function(e,s){n.doError("删除失败："+(e.message||s))})})},e.edit=function(e){i({tpl:"asset/tpl/dashboard/security/permission_form.html",ctrl:"PerimssionConfigFormCtrl",permission:e})},e.add=function(){i({tpl:"asset/tpl/dashboard/security/permission_form.html",ctrl:"PerimssionConfigFormCtrl"})}}]),dashboard.controller("PerimssionConfigFormCtrl",["$scope","$http","permission","$modalInstance","Messager",function(e,s,t,a,n){if(e.permissions={upload:!1,download:!1,create:!1,move:!1,copy:!1,lock:!1,rename:!1,remove:!1,revert:!1,view:!1,share:!1,tag:!1,review:!1},e.checkAll=function(s){for(var t in e.permissions)e.permissions[t]=s},e.permission=t,e.operation="新建",null!=t){for(var l=e.permission.permissions.split(","),i=0;i<l.length;i++)e.permissions[l[i]]=!0;e.operation="编辑"}e.save=function(){var n="conf/permission/save";null!=t.id&&(n="conf/permission/update");var l=[];e.saving=!0;for(var i in e.permissions)!0===e.permissions[i]&&l.push(i);e.permission.permissions=l.join(",");var o=e.toaster.wait("正在保存...");s.post(n,e.permission).success(function(s){e.saving=!1,s.success?(o.doSuccess("保存成功"),a.close()):o.doError("保存失败："+s.message)}).error(function(s,t){e.saving=!1,o.doError("保存失败："+(s.message||t))})},e.cancel=function(){e.permissionConfigForm.$dirty?n.confirm("提示","您已经进行了修改，是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")}}]),dashboard.controller("StorageConfigCtrl",["$scope","$http","Messager","$modal","toaster",function(e,s,t,a,n){function l(){e.status.loading=!0,s.get("conf/storage").success(function(s,t,a,n){if(e.status.loading=!1,s.success){var l=s.storages;l.map(function(e){return e.icon="asset/img/oss.png",e}),e.storages=l}else e.status.loadError=!0,e.status.loadErrorText="获取存储列表失败："+s.message,e.toaster.pop("error","提示",s.message)}).error(function(){e.status.loading=!1,e.status.loadError=!0,e.status.loadErrorText="获取存储列表失败",e.toaster.pop("error","提示","加载失败："+status.statusCode)})}function i(e){a.open({templateUrl:e.tpl,controller:e.ctrl,backdrop:"static",resolve:{id:function(){return e.id}}}).result.then(function(){l()},function(){})}e.status={isopen:!1,loading:!1},l(),e.clearSelected=function(){e.selected&&(e.selected.selected=!1,e.selected=null)},e.setSelected=function(s){e.selected&&e.selected!=s&&(e.selected.selected=!1),!0!==s.selected?(s.selected=!0,e.selected=s):(s.selected=!1,e.selected=null)},e.removeStorage=function(){if(e.selected){var a=e.selected,n="conf/storage/oss/delete";console.log(a),"ftp"==a.type?n="":"hdfs"==a.type&&(n=""),t.confirm("提示","确定要删除?").then(function(t){s.post(n,{id:e.selected.id}).success(function(s,t,a,n){s.success?l():e.toaster.pop("error","提示","刪除失败："+s.message)}).error(function(s){e.toaster.pop("error","提示","刪除失败，稍候再试")})})}},e.edit=function(){e.selected&&i({tpl:"asset/tpl/dashboard/storage/oss_form.html",ctrl:"OSSStorageFormCtrl",id:e.selected.id})},e.addOSS=function(){i({tpl:"asset/tpl/dashboard/storage/oss_form.html",ctrl:"OSSStorageFormCtrl"})}}]),dashboard.controller("OSSStorageFormCtrl",["$scope","$http","id","$modalInstance","Messager",function(e,s,t,a,n){function l(s){e.testStatus.testing=!1,e.testStatus.testText="测试连接",e.testResult=s}e.storage={},e.operation="添加",null!=t&&(s.get("conf/storage/oss",{params:{id:t}}).success(function(s){e.storage=s.oss}),e.operation="编辑"),e.save=function(){e.result=null;var n="conf/storage/oss/save";null!=t&&(n="conf/storage/oss/update"),s.post(n,e.storage).success(function(s){s.success?a.close():e.result=s}).error(function(s,t){e.result={success:!1,message:"保存失败："+t}})},e.testStatus={testText:"测试连接",testing:!1,testPassed:!1},e.test=function(){e.testResult=null,e.testStatus.testing=!0,e.testStatus.testText="正在连接...",s.post("conf/storage/oss/test",e.storage).success(function(e){e.message="连接成功",l(e)}).error(function(){l({success:!1,message:"连接发生错误"})})},e.cancel=function(){e.ossStorageForm.$dirty?n.confirm("提示","已经编辑了数据是否要关闭?").then(function(e){a.dismiss("cancel")},function(){}):a.dismiss("cancel")},e.$watch("storage",function(){e.testStatus.testPassed=!1,e.showResult=!1},!0)}]),dashboard.controller("StorageSettingCtrl",["$scope","$http","$state","toaster",function(e,s,t,a){function n(){s.get("setting/storage").success(function(e,s,t,n){e.success?i(e.setting):a.pop("error","提示","加载存储设置失败："+e.message)}).error(function(){a.pop("error","提示","加载存储设置失败："+status.statusCode)})}function l(s){s||(s=[]),s.map(function(e,s){return e.id=e.type+"#"+e.id,delete e.type,e}),s.push({id:"local",name:"本地存储"}),e.storages=s}function i(s){var t=s.fileStorage;s.fileStorageType=t.substring(0,t.indexOf("@")),s.fileStoragePath=t.substring(t.indexOf("@")+1,t.length);var a=s.resourceStorage;s.resourceStorageType=a.substring(0,a.indexOf("@")),s.resourceStoragePath=a.substring(a.indexOf("@")+1,a.length),e.setting=s}s.get("conf/storage").success(function(e,s,t,n){e.success?l(e.storages):a.pop("error","提示","加载存储列表失败："+e.message)}).error(function(){a.pop("error","提示","加载存储列表失败："+status.statusCode)}),n(),e.fileStorageChange=function(){e.setting.fileStorage=e.setting.fileStorageType+"@"+e.setting.fileStoragePath},e.resourceStorageChange=function(){e.setting.resourceStorage=e.setting.resourceStorageType+":"+e.setting.resourceStoragePath},e.save=function(){s.post("setting/storage",e.setting).success(function(s,t,n,l){s.success?(e.storageSettingForm.$setPristine(),e.storageSettingForm.$setUntouched(),a.pop("success","提示","保存成功")):a.pop("error","提示","保存失败："+s.message)}).error(function(){a.pop("error","提示","保存设置失败："+status.statusCode)})},e.reset=function(){e.storageSettingForm.$setPristine(),e.storageSettingForm.$setUntouched(),n()}}]),dashboard.controller("TaskManagerCtrl",["$scope","$http","Messager","$modal","toaster",function(e,s,t,a,n){e.status={isopen:!1,loading:!1,syncing:!1,syncText:"导入任务"},e.open=function(s){s.preventDefault(),s.stopPropagation(),e.opened=!0},e.load=function(){e.status.loading=!0,s.get("task/list").success(function(s,t,a,n){e.status.loading=!1,s.success?e.tasks=s.tasks:(e.status.loadError=!0,e.status.loadErrorText="获取存储列表失败："+s.message,e.toaster.pop("error","提示",s.message))}).error(function(){e.status.loading=!1,e.status.loadError=!0,e.status.loadErrorText="获取存储列表失败",e.toaster.pop("error","提示","加载失败："+status.statusCode)})},e.load(),e.sync=function(){e.status.syncing=!0,e.status.syncText="正在同步...",s.post("task/sync").success(function(s,t,a,n){e.status.syncing=!1,e.status.syncText="同步任务",s.success?e.toaster.pop("success","提示","同步任务完成"):e.toaster.pop("error","提示","同步任务失败："+s.message)}).error(function(s,t,a,n){e.status.syncing=!1,e.status.syncText="同步任务",e.toaster.pop("error","提示","同步任务失败："+t.statusCode)})}}]),dashboard.controller("ClusterSettingCtrl",["$scope","$http","Messager","$rootScope",function(e,s,t,a){function n(){var t=a.toaster.wait("正在加载配置");s.get("setting/cluster").success(function(s,a,n,l){s.success?(t.doClose(),e.setting=s.setting):t.doError("加载集群配置失败："+s.message)}).error(function(e,s){t.doError("加载集群配置失败："+(e.message||s))})}n(),e.save=function(){s.post("setting/cluster",e.setting).success(function(s,t,n,l){s.success?(e.settingForm.$setPristine(),e.settingForm.$setUntouched(),a.toaster.success("保存成功")):a.toaster.error("保存失败："+s.message)}).error(function(e,s){a.toaster.error("保存失败："+(e.message||s))})},e.reset=function(){e.settingForm.$setPristine(),e.settingForm.$setUntouched(),n()}}]),dashboard.controller("SsoSettingCtrl",["$scope","$http","Messager","$rootScope",function(e,s,t,a){function n(){var t=a.toaster.wait("正在加载配置");s.get("setting/sso").success(function(s,a,n,l){s.success?(t.doClose(),e.setting=s.setting):t.doError("加载配置失败："+s.message)}).error(function(e,s){t.doError("加载配置失败："+(e.message||s))})}n(),e.save=function(){s.post("setting/sso",e.setting).success(function(s,t,n,l){s.success?(e.settingForm.$setPristine(),e.settingForm.$setUntouched(),a.toaster.success("保存成功")):a.toaster.error("保存失败："+s.message)}).error(function(e,s){a.toaster.error("保存失败："+(e.message||s))})},e.reset=function(){e.settingForm.$setPristine(),e.settingForm.$setUntouched(),n()}}]),dashboard.controller("MailSettingCtrl",["$scope","$http","Messager","$rootScope",function(e,s,t,a){function n(){var t=a.toaster.wait("正在加载配置");s.get("setting/mail").success(function(s,a,n,l){s.success?(t.doClose(),e.setting=s.setting):t.doError("加载配置失败："+s.message)}).error(function(e,s){t.doError("加载配置失败："+(e.message||s))})}n(),e.save=function(){s.post("setting/mail",e.setting).success(function(s,t,n,l){s.success?(e.settingForm.$setPristine(),e.settingForm.$setUntouched(),a.toaster.success("保存成功")):a.toaster.error("保存失败："+s.message)}).error(function(e,s){a.toaster.error("保存失败："+(e.message||s))})},e.reset=function(){e.settingForm.$setPristine(),e.settingForm.$setUntouched(),n()}}]),angular.module("dashboard").run(["$templateCache",function(e){e.put("asset/tpl/dashboard/app/mapping_form.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>文档配置 - {{operation}}</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=mappingConfigForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label">后缀</label><div class=col-sm-9><textarea rows=3 name=extensions ng-model=mapping.extensions required class=form-control></textarea><span class="help-block m-b-none">多个后缀使用“,”进行隔开</span></div></div><div class=form-group><label class="col-sm-3 control-label">分类</label><div class=col-sm-9><select ng-model=mapping.category ng-change=fileStorageChange() ng-options="category.value as category.name for category in categories" required class=form-control></select></div></div><div class=form-group><label class="col-sm-3 control-label">图标</label><div class=col-sm-9><div style=margin-bottom:10px ng-show="mapping.icon != null"><img id=mappingIcon ng-src="{{mapping.icon | resource}}" style="max-height: 80px"></div><button type=button class="btn btn-default" onclick="$(\'#iconFileInput\').click();" ng-disabled=icon.uploading>{{icon.operation}}</button> 推荐尺寸240*240，大小不超过2MB<div class="alert alert-danger" ng-show=icon.uploadError style="margin-top: 5px;margin-bottom:0px" role=alert>{{icon.uploadErrorText}}</div></div></div><div class="form-group m-b-none" ng-show=result><div class=col-sm-12><div class="alert alert-danger m-b-none" role=alert>{{result.message}}</div></div></div><input id=iconFileInput type=file class=hidden onchange=angular.element(this).scope().uploadIcon() accept=image/*></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled="mappingConfigForm.$invalid || !mappingConfigForm.$dirty">保存</button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/app/mappings.html",'<div ng-controller=MappingConfigCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-5"><h1 class="m-n font-thin h3">文档设置</h1></div><div class="col-sm-6 col-xs-7" style="text-align: right"><button class="btn btn-primary" ng-click=add()>添加</button> <button class="btn btn-primary" ng-disabled=!selected ng-click=edit()>编辑</button> <button class="btn btn-primary" ng-disabled=!selected ng-click=remove()>删除</button></div></div></div><div class="wrapper-md app-inner"><div class=row><div class=col-sm-12 style="padding: 10px 5px"><form class=form-inline><div class=form-group><input class=form-control ng-model=condition.extensions id=extensions placeholder=扩展名></div><div class=form-group><select ng-model=condition.category class=form-control><option ng-repeat="category in categories" value={{category.value}}>{{category.name}}</option></select></div></form></div><div class=col-sm-12><p class=m-t ng-show=status.loading>正在加载文件配置列表....</p><p class=m-t ng-show="!status.loading && status.loadError">{{status.loadErrorText}}</p><div class=row><div class="mapping col-md-3 col-xs-12 col-sm-6" ng-repeat="mapping in mappings | filter:search" ng-click=setSelected(mapping)><div class=mapping-content ng-class="{\'mapping-selected\':mapping.selected === true}"><img class=mapping-icon ng-src="{{mapping.icon | resource}}"><div class=mapping-inner><div class=mapping-extensions>扩展名：{{mapping.extensions}}</div><div class=mapping-category>分类：{{mapping.categoryName}}</div></div></div></div></div></div></div></div></div>'),e.put("asset/tpl/dashboard/app/settings.html",'<div ng-controller=SettingsCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-6"><h1 class="m-n font-thin h3">应用设置</h1></div><div class="col-sm-6 col-xs-6" style="text-align: right"><button class="btn btn-primary" ng-disabled="settingForm.$invalid || !settingForm.$dirty" ng-click=save()>保存</button> <button class="btn btn-minor" ng-disabled=!settingForm.$dirty ng-click=reset()>重置</button></div></div></div><div class="wrapper-md app-inner"><form name=settingForm class="form-horizontal form-property form-validation"><input id=imageFileInput type=file class=hidden onchange=angular.element(this).scope().upload() accept=image/*><div class="panel panel-default"><div class="panel-heading font-bold">应用设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">应用名称</label><div class=col-sm-7><input name=appName ng-model=setting.appName class=form-control> <span class="help-block m-b-none">用于在系统中显示的应用名称</span></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">应用程序LOGO</label><div class=col-sm-7><div class=m-b-sm><img id=appLogoImage ng-src="{{setting.appLogo | resource}}"></div><button class="btn btn-default" ng-click="selectImage(\'appLogo\')" ng-disabled="uploadType == \'appLogo\' && uploading"><span ng-show="uploadType == \'appLogo\' && uploading === true">正在上传...</span> <span ng-show="uploadType != \'appLogo\' || uploading !== true">选择LOGO</span></button> 推荐尺寸240*240，大小不超过2MB<div class="alert alert-danger m-t-xs" ng-show="uploadType == \'appLogo\' && uploadResult.success === false && !uploading">{{uploadResult.message}}</div></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">应用程序图标</label><div class=col-sm-7><div class=m-b-sm><img id=appIconImage ng-src="{{setting.appIcon | resource}}"></div><button class="btn btn-default" ng-click="selectImage(\'appIcon\')" ng-disabled="uploadType == \'appIcon\' && uploading"><span ng-show="uploadType == \'appIcon\' && uploading === true">正在上传...</span> <span ng-show="uploadType != \'appIcon\' || uploading !== true">选择图标</span></button> 推荐尺寸24*24，大小不超过200KB<div class="alert alert-danger m-t-xs" ng-show="uploadType == \'appIcon\' && uploadResult.success === false && !uploading">{{uploadResult.message}}</div></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">文档设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">默认文档图标</label><div class=col-sm-7><div class=m-b-sm><img id=defaultDocIconImage ng-src="{{setting.defaultDocIcon | resource}}"></div><button class="btn btn-default" ng-click="selectImage(\'defaultDocIcon\')" ng-disabled="uploadType == \'defaultDocIcon\' && uploading"><span ng-show="uploadType == \'defaultDocIcon\' && uploading === true">正在上传...</span> <span ng-show="uploadType != \'defaultDocIcon\' || uploading !== true">选择图标</span></button> 推荐尺寸48*48大小内，大小不超过512KB<div class="alert alert-danger m-t-xs" ng-show="uploadType == \'defaultDocIcon\' && uploadResult.success === false && !uploading">{{uploadResult.message}}</div></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">普通文件夹图标</label><div class=col-sm-7><div class=m-b-sm><img id=publicFolderIconImage ng-src="{{setting.publicFolderIcon | resource}}"></div><button class="btn btn-default" ng-click="selectImage(\'publicFolderIcon\')" ng-disabled="uploadType == \'publicFolderIcon\' && uploading"><span ng-show="uploadType == \'publicFolderIcon\' && uploading === true">正在上传...</span> <span ng-show="uploadType != \'publicFolderIcon\' || uploading !== true">选择图标</span></button> 推荐尺寸48*48大小内，大小不超过512KB<div class="alert alert-danger m-t-xs" ng-show="uploadType == \'publicFolderIcon\' && uploadResult.success === false && !uploading">{{uploadResult.message}}</div></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">共享文件夹图标</label><input id=iconFileInput type=file class=hidden onchange=angular.element(this).scope().uploadIcon()><div class=col-sm-7><div class=m-b-sm><img id=privateFolderIconImage ng-src="{{setting.privateFolderIcon | resource}}"></div><button class="btn btn-default" ng-click="selectImage(\'privateFolderIcon\')" ng-disabled="uploadType == \'privateFolderIcon\' && uploading"><span ng-show="uploadType == \'privateFolderIcon\' && uploading === true">正在上传...</span> <span ng-show="uploadType != \'privateFolderIcon\' || uploading !== true">选择图标</span></button> 推荐尺寸48*48大小内，大小不超过512KB<div class="alert alert-danger m-t-xs" ng-show="uploadType == \'privateFolderIcon\' && uploadResult.success === false && !uploading">{{uploadResult.message}}</div></div></div></div></div></form></div></div>'),e.put("asset/tpl/dashboard/blank.html",""),e.put("asset/tpl/dashboard/blocks/aside.html",'<div class="aside-wrap b-r" style=height:100%><div class=navi-wrap><nav ui-nav class=navi ng-include="\'${dashboardUrl}/tpl/blocks/nav.html\'"></nav></div></div>'),e.put("asset/tpl/dashboard/blocks/header.html",'<div class="navbar-header bg-primary"><button class="pull-right visible-xs"><i class="glyphicon glyphicon-log-out"></i></button> <button class="pull-right visible-xs" ui-toggle-class=off-screen data-target=.app-aside ui-scroll=app><i class="glyphicon glyphicon-align-justify"></i></button> <a href=#/ class="navbar-brand text-lt visible-xs" style="text-align: left"><span class="hidden-folded m-l-xs"><img ng-src="{{logo | resource}}" style="max-width: 30px;max-height: 30px;margin-right:10px">控制台</span></a></div><div class="collapse pos-rlt navbar-collapse box-shadow {{dashboard.settings.navbarHeaderColor}}" style=padding-left:0px;margin-left:0px><a href=#/ class="navbar-brand text-lt"><span class="hidden-folded m-l-xs"><img ng-src="{{logo | resource}}" style="max-width: 30px;max-height: 30px;margin-right:10px">{{dashboard.name}} - 控制台</span></a><ul class="nav navbar-nav navbar-right"><li style=padding:8px><button class="btn btn-default">退出控制台 <i class="glyphicon glyphicon-log-out"></i></button></li></ul></div>'),e.put("asset/tpl/dashboard/blocks/nav.html",'<ul class=nav><li ng-class="{active:$state.includes(\'app.table\')}"><a ui-sref=/index class=auto><i class="glyphicon glyphicon-home"></i> <span>控制台首页</span></a></li><li ng-class="{active:$state.includes(\'organization\')}"><a class=auto ui-sref=organization><i class="fa fa-group"></i> <span>组织架构</span></a></li><li ng-class="{active:$state.includes(\'app\')}"><a href class=auto><span class="pull-right text-muted"><i class="fa fa-fw fa-angle-right text"></i> <i class="fa fa-fw fa-angle-down text-active"></i> </span><i class="glyphicon glyphicon-th-large"></i> <span>应用管理</span></a><ul class="nav nav-sub dk"><li ui-sref-active=active><a ui-sref=app.settings><span>应用设置</span></a></li><li ui-sref-active=active><a ui-sref=app.mapping><span>文档设置</span></a></li></ul></li><li ng-class="{active:$state.includes(\'storage\')}"><a href class=auto><span class="pull-right text-muted"><i class="fa fa-fw fa-angle-right text"></i> <i class="fa fa-fw fa-angle-down text-active"></i> </span><i class="fa fa-database"></i> <span>存储管理</span></a><ul class="nav nav-sub dk"><li ui-sref-active=active><a ui-sref=storage.settings><span>存储设置</span></a></li><li ui-sref-active=active><a ui-sref=storage.list><span>存储配置</span></a></li></ul></li><li ng-class="{active:$state.includes(\'security\')}"><a href class=auto><span class="pull-right text-muted"><i class="fa fa-fw fa-angle-right text"></i> <i class="fa fa-fw fa-angle-down text-active"></i> </span><i class="fa fa-shield icon"></i> <span>安全管理</span></a><ul class="nav nav-sub dk"><li ui-sref-active=active><a ui-sref=security.settings><span>安全设置</span></a></li><li ui-sref-active=active><a ui-sref=security.permission><span>权限配置</span></a></li><li ui-sref-active=active><a ui-sref=security.loginLog><span>登录日志</span></a></li><li ui-sref-active=active><a ui-sref=security.activity><span>操作日志</span></a></li></ul></li><li><a href class=auto><span class="pull-right text-muted"><i class="fa fa-fw fa-angle-right text"></i> <i class="fa fa-fw fa-angle-down text-active"></i> </span><i class="fa fa-gears"></i> <span>系统管理</span></a><ul class="nav nav-sub dk"><li ui-sref-active=active><a ui-sref=sys.cluster><span>集群设置</span></a></li><li ui-sref-active=active><a ui-sref=sys.sso><span>单点登录</span></a></li><li ui-sref-active=active><a ui-sref=sys.mail><span>邮件服务器</span></a></li><li ui-sref-active=active><a ui-sref=layout.app><span>备份管理</span></a></li><li ui-sref-active=active><a ui-sref=sys.task><span>任务管理</span></a></li><li ui-sref-active=active><a ui-sref=sys.monitor><span>数据库监控</span></a></li></ul></li><li><a href=/index class=auto><i class="glyphicon glyphicon-log-out"></i> <span>退出</span></a></li></ul>'),e.put("asset/tpl/dashboard/dashboard.html",'<div data-ng-include=" \'tpl/blocks/header.html\' " class="app-header navbar"></div><div data-ng-include=" \'tpl/blocks/aside.html\' " class="app-aside hidden-xs {{dashboard.settings.asideColor}}"></div><div class=app-content><div ui-butterbar></div><a href class="off-screen-toggle hide" ui-toggle-class=off-screen data-target=.app-aside></a><div class="app-content-body app-content-full fade-in-up" ui-view></div></div>'),e.put("asset/tpl/dashboard/index.html",'<div class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-12"><h1 class="m-n font-thin h3 text-black">控制台首页</h1></div></div></div><div class=wrapper-md><div class=row><div class=col-md-12><div class="row row-sm text-center"><div class=col-xs-6><div class="panel padder-v item"><div class="h1 text-primary font-thin h1">{{report.sumOfSize | formatSize}}</div><span class="text-muted text-xs">总共使用量</span></div></div><div class=col-xs-6><div href class="block panel padder-v item"><span class="text-primary font-thin h1 block">{{report.countOfFile}} </span><span class="text-muted text-xs">文件总数</span></div></div></div></div></div><div class="panel wrapper"><div class=row><div class="col-md-12 b-r b-light no-border-xs" ui-sref-active=active><h4 class="font-thin m-t-none m-b-md">快速导航</h4><div class=m-b><div class=m-b ui-sref-active=active><span class="label text-base bg-primary pos-rlt m-r text-white"><i class="arrow right arrow-primary"></i>组织架构</span> <a href=#/organization class=auto ui-sref=organization>组织结构</a></div><div class=m-b ui-sref-active=active><span class="label text-base bg-primary pos-rlt m-r text-white"><i class="arrow right arrow-primary"></i>应用管理</span> <a href=#/app/settings ui-sref=app.settings>应用设置</a> <a href=#/app/mapping ui-sref=app.mapping>文档设置</a></div><div class=m-b><span class="label text-base bg-primary pos-rlt m-r text-white"><i class="arrow right arrow-primary"></i>存储管理</span> <a href=#/storage/settings ui-sref=storage.settings>储存设置</a> <a href=#/storage/list ui-sref=storage.list>存储配置</a></div><div class=m-b><span class="label text-base bg-primary pos-rlt m-r text-white"><i class="arrow right arrow-primary"></i>安全管理</span> <a href=#/security/settings ui-sref=security.settings><span>安全设置</span> </a><a href=#/security/login/log ui-sref=security.loginLog><span>登录日志</span> </a><a href=#/security/activity ui-sref=security.activity><span>操作日志</span></a></div></div></div></div></div></div></div>'),e.put("asset/tpl/dashboard/organization/department_form.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>部门 - {{operation}}</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=departmentForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label required">部门名称</label><div class=col-sm-9><input name=name ng-model=department.name required class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label required">部门编号</label><div class=col-sm-9><input name=code ng-model=department.code required ng-minlength=2 class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">所属部门</label><div class=col-sm-9><input name=parentName ng-model=department.parent.name readonly class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">排序号</label><div class=col-sm-9><input type=number name=orderNo ng-model=department.orderNo class=form-control></div></div><div class="form-group m-b-none" ng-show=result><div class="col-sm-12 m-b-none"><div class="alert alert-danger" role=alert>{{result.message}}</div></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled="departmentForm.$invalid || !departmentForm.$dirty">保存</button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/organization/department_move.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>{{operation}} [{{department.name}}] 到</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=departmentMoveForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label">所属部门</label><div class=col-sm-9><hc-combo-tree ng-model=newParent tree-config=treeConfig on-change=onChange(node);></hc-combo-tree></div></div><div class=form-group ng-show="invalid && changed"><div class="col-sm-12 m-t-md text-center"><span class="alert alert-danger" role=alert>不能移动到自身或者自身以下的部门</span></div></div><div class=form-group ng-show=result><div class="col-sm-12 m-t-md text-center"><div class="alert alert-danger" role=alert>{{result.message}}</div></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled="(invalid && changed) || (!changed)">确定</button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/organization/organization.html",'<div class="w-full h-full" ng-controller=OrganizationCtrl><div class=app-ctrl style="padding-top: 67px"><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-12 col-xs-12"><h1 class="m-n font-thin h3">组织架构管理</h1></div></div></div><div class="app-inner pos-rlt"><div class="bg-light lter b-r pos-abt w-md h-full"><hc-tree tree-control=tree load-asyn=true on-option-click=onTreeOptionClick(node,event) on-init=onTreeInit() open-folder-icon="fa fa-users" folder-icon="fa fa-users" leaf-icon="fa fa-users" show-option-icon=true on-selection-change=onSelectionChange(selection); load-url=/organization/department/list></hc-tree></div><div class="h-full bg-light lter" ng-controller=UserCtrl style="padding-left: 240px"><div class="row wrapper-sm b-b m-l-non m-r-none"><div class=col-sm-4><h1 class="m-n font-thin h4 inline" style="padding:7px 10px"><i class="fa fa-users"></i> {{current.name}}</h1><span class=text-sm style=color:#aaa ng-show="users.length > 0">( {{users.length}}人 )</span></div><div class=col-sm-8 style="text-align: right"><button class="btn btn-primary" ng-disabled=!current ng-click=addUser()>新增用户</button> <button class="btn btn-primary" ng-disabled=!selected ng-click=editUser() ng-disabled=selected.executing>编辑用户</button><div class=btn-group dropdown is-open=status.isopen><button type=button class="btn btn-default" dropdown-toggle ng-disabled="!selected || selected.executing">更多&nbsp;<span class=caret></span></button><ul class=dropdown-menu role=menu style=left:inherit;right:0px><li><a href ng-click=move();>调整部门</a></li><li><a href ng-click=reset($event)>重置密码</a></li><li><a href ng-click=transfer()>文档移交</a></li><li><a href ng-click=setQuota($event)>调整配额</a></li><li><a href ng-click=transferAdmin() ng-show="selected.role != \'SYS_ADMIN\'">移交管理员权限</a></li></ul></div><button class="btn btn-default">导入</button></div></div><div class=table-responsive ng-show="!status.loading && users.length > 0"><table class="table table-hover b-b b-light"><thead><tr><th ng-click="title=\'username\';desc=!desc" width=30%>用户名 <i ng-show="title == \'username\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th ng-click="title=\'name\';desc=!desc" width=20%>姓名 <i ng-show="title == \'name\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th ng-click="title=\'email\';desc=!desc" width=30%>邮箱 <i ng-show="title == \'email\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th ng-click="title=\'status\';desc=!desc" width=10%>状态 <i ng-show="title == \'status\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th width=10%>操作</th></tr></thead><tbody><tr><th><input class="input-sm form-control" placeholder="" ng-model=condition.username></th><th><input class="input-sm form-control" placeholder="" ng-model=condition.name></th><th><input class="input-sm form-control" placeholder="" ng-model=condition.email></th><th><select class="input-sm form-control" ng-model=condition.status><option></option><option value=2>正常</option><option value=1>禁用</option><option value=3>锁定</option></select></th><th></th></tr><tr ng-class="{\'user-selected\':user.selected}" ng-click=select(user); ng-repeat="user in users | filter:{username:condition.username,name:condition.name,email:condition.email,status:condition.status} | orderBy: title : desc" valign=middle style="line-height: 24px"><td><img ng-src="{{user.avatar | resource}}" class="img-circle m-r-xs" style=height:24px alt=...> <span class=m-r-xs>{{user.username}}</span> <span ng-if="user.role == \'SYS_ADMIN\'" class="label label-sm label-minor">管理员</span> <span ng-if="user.role == \'DOC_ADMIN\'" class="label label-sm label-minor">文档管理员</span></td><td>{{user.name}}</td><td>{{user.email}}</td><td>{{user.status | translate:\'hr.user.status\'}}</td><td><i class="fa fa-ban hover text-md m-r-xs" ng-show="user.status == 2" ng-click=disable(user,$event); tooltip=禁用></i> <i class="fa fa-check-circle-o hover text-md m-r-xs" ng-show="user.status == 1" ng-click=enable(user,$event); tooltip=启用></i> <i class="fa fa-lock hover text-md m-r-xs" ng-show="user.status == 2" ng-click=lock(user,$event); tooltip=锁定></i> <i class="fa fa-unlock hover text-md m-r-xs" ng-show="user.status == 3" ng-click=unlock(user,$event); tooltip=解锁></i></td></tr></tbody></table></div><div class="wrapper-xl text-center" ng-show=status.loading><img ng-src="{{\'asset/img/loading.gif\'  | resource}}"><p class=m-t-sm>正在加载</p></div><div class="wrapper-xl text-center" ng-show="(users.length == 0 || !users) && !status.loading"><img ng-src="{{\'asset/img/user_empty.png\' | resource}}"><p class=m-t-md>该部门中没有员工</p></div></div></div></div><ul id=departmentMenu class=dropdown-menu role=menu><li><a tabindex=-1 href="" ng-click=addDepartment()>添加子部门</a></li><li><a tabindex=-1 href="" ng-click=editDepartment()>编辑部门</a></li><li class=divider ng-show="selected.$parent.$root !== true"></li><li><a tabindex=-1 ng-show="selected.$parent.$root !== true" ng-click=moveDepartment()>移动部门到...</a></li><li><a tabindex=-1 ng-show="selected.$parent.$root !== true" ng-click=deleteDepartment()>删除部门</a></li></ul></div>'),e.put("asset/tpl/dashboard/organization/user_form.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>用户 - {{operation}}</h4></div><div class="modal-body wrapper-md"><div class=row><div class=col-sm-12><form name=userForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label required">用户名</label><div class=col-sm-9><input name=name ng-model=user.username required class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label required">姓名</label><div class=col-sm-9><input name=name ng-model=user.name required ng-minlength=2 class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label required">邮箱</label><div class=col-sm-9><input type=email name=email ng-model=user.email class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">手机号</label><div class=col-sm-9><input name=phoneNumber ng-model=user.phoneNumer class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label required">所属部门</label><div class=col-sm-9><input name=department.name ng-model=user.department.name readonly class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label"></label><div class=col-sm-9><label class=i-checks><input type=checkbox name=role ng-true-value="\'DOC_ADMIN\'" ng-false-value="\'USER\'" ng-model=user.role ng-checked="user.role == \'DOC_ADMIN\'"> <i></i>设置为文档管理员</label></div></div><div class=form-group><div class=col-sm-12><div class="alert alert-info" style=margin-bottom:0px role=alert><b>提示：</b>用户添加后密码为系统设置的默认密码，用户第一次登录之后必须修改密码</div></div></div><div class=form-group ng-show=result><div class=col-sm-12><div class="alert alert-danger" style=margin-bottom:0px role=alert>{{result.message}}</div></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled="saving=== true || userForm.$invalid || !userForm.$dirty">保存</button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/organization/user_move.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>{{operation}} [{{user.name}}] 到</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=departmentMoveForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label">所属部门：</label><div class=col-sm-9><hc-combo-tree ng-model=department tree-config=treeConfig on-change=onChange(node);></hc-combo-tree></div></div><div class="form-group m-b-none" ng-show=result><div class="col-sm-12 m-t-md text-center"><div class="alert alert-danger m-b-none" role=alert>{{result.message}}</div></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled=(!changed)>确定</button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/organization/user_quota.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>用户 [{{user.name}}] 配额调整</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=userQutaoForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label">配额：</label><div class=col-sm-9><input type=number class="form-control w-xs inline" ng-model=user.quota min=1> GB</div></div><div class="form-group m-b-none" ng-show=result><div class="col-sm-12 m-t-md text-center"><div class="alert alert-danger m-b-none" role=alert>{{result.message}}</div></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled="useQuatoForm.$invalid || !userQutaoForm.$dirty || saving"><span ng-show=!saving>保存</span> <span ng-show=saving>正在保存</span></button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/organization/user_transfer_admin.html",'<div class=m-c><div class=modal-header><div class="pull-right col-md-6 no-padder"><div class=input-group><input class=form-control ng-model=condition placeholder=搜索:用户名/姓名/拼音><div class=input-group-btn><button type=button class="btn btn-default" ng-show=condition ng-click=clear();><i class="glyphicon glyphicon-remove"></i></button> <button type=button class="btn btn-default" ng-click=search();><i class="glyphicon glyphicon-search"></i></button></div></div></div><h4 class=modal-title style="line-height: 34px"><i class="glyphicon glyphicon-transfer"></i> 移交管理员权限</h4></div><div class="modal-body no-padder"><div ng-show=!searching style="height: 300px"><div class="col-sm-6 h-full b-r wrapper-sm"><hc-tree tree-control=tree load-asyn=true on-init=onTreeInit() open-folder-icon="fa fa-users" folder-icon="fa fa-users" leaf-icon="fa fa-users" on-selection-change=loadUser(selection); load-url=/organization/department/list></hc-tree></div><div class="col-sm-6 h-full wrapper-sm"><div class="wrapper-xl text-center" ng-show=loading><img src=asset/img/loading.gif><p class=m-t-sm>正在加载</p></div><div ng-repeat="user in users" class="wrapper-xs hover-bg" ng-show=!loading ng-click=select(user);><img ng-src="{{user.avatar | resource}}" class=img-circle style=height:30px alt=...> <span class=m-l-sm style="line-height: 30px">{{user.name}}</span></div></div></div><div class=wrapper-sm ng-show=searching style="height: 300px"><div class="col-md-4 wrapper-xs hover-bg" ng-repeat="user in result" ng-dblclick=transfer(user) ng-click=select(user);><img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:50px alt=...><div class=inline><span class=m-l-sm style="line-height: 30px">{{user.name}}</span><br><span class=m-l-sm style="line-height: 20px;font-size:12px;color:#bbb">{{user.department.name}}</span></div></div><div class=col-sm-12 ng-show="result.length == 0"><div class="wrapper-xs text-center"><img ng-src="{{\'asset/img/user_empty.png\' | resource}}"><p class=m-t-sm>没有搜索到用户</p></div></div><div class="col-sm-12 permission-user-part" ng-show=loading><div class="wrapper-xl text-center"><img ng-src="{{\'asset/img/loading.gif\' | resource}}"><p class=m-t-sm>正在加载</p></div></div></div><div class="wrapper-sm b-t text-center" ng-hide=!selected><div ng-show="selected.id != user.id"><div class=inline style="line-height: 30px">移交给：</div><img ng-src="{{selected.avatar | resource}}" class=img-circle style="height:24px;margin-top: -5px" alt=...><div class=inline style="line-height: 30px">{{selected.name}}</div></div><div ng-show="selected.id == user.id"><div class="inline text-danger" style="line-height: 30px">不能移交给自己</div></div></div></div><div class=modal-footer><button type=button class="btn btn-primary" ng-click=ok() style="margin-left: 5px" ng-disabled="!selected || saving"><span ng-show=!saving>移交</span> <span ng-show=saving>正在移交</span></button> <button type=button class="btn btn-default" ng-click=close()>取消</button></div></div>'),e.put("asset/tpl/dashboard/organization/user_transfer.html",'<div class=m-c><div class=modal-header><div class="pull-right col-md-6 no-padder"><div class=input-group><input class=form-control ng-model=condition placeholder=搜索:用户名/姓名/拼音><div class=input-group-btn><button type=button class="btn btn-default" ng-show=condition ng-click=clear();><i class="glyphicon glyphicon-remove"></i></button> <button type=button class="btn btn-default" ng-click=search();><i class="glyphicon glyphicon-search"></i></button></div></div></div><h4 class=modal-title style="line-height: 34px"><i class="glyphicon glyphicon-transfer"></i> 用户 [{{user.name}}] 文档移交</h4></div><div class="modal-body no-padder"><div ng-show=!searching style="height: 300px"><div class="col-sm-6 h-full b-r wrapper-sm"><hc-tree tree-control=tree load-asyn=true on-init=onTreeInit() open-folder-icon="fa fa-users" folder-icon="fa fa-users" leaf-icon="fa fa-users" on-selection-change=loadUser(selection); load-url=/organization/department/list></hc-tree></div><div class="col-sm-6 h-full wrapper-sm"><div class="wrapper-xl text-center" ng-show=loading><img src=asset/img/loading.gif><p class=m-t-sm>正在加载</p></div><div ng-repeat="user in users" class="wrapper-xs hover-bg" ng-show=!loading ng-click=select(user);><img ng-src="{{user.avatar | resource}}" class=img-circle style=height:30px alt=...> <span class=m-l-sm style="line-height: 30px">{{user.name}}</span></div></div></div><div class=wrapper-sm ng-show=searching style="height: 300px"><div class="col-md-4 wrapper-xs hover-bg" ng-repeat="user in result" ng-dblclick=transfer(user) ng-click=select(user);><img ng-src="{{user.avatar | resource}}" class="img-circle pull-left" style=height:50px alt=...><div class=inline><span class=m-l-sm style="line-height: 30px">{{user.name}}</span><br><span class=m-l-sm style="line-height: 20px;font-size:12px;color:#bbb">{{user.department.name}}</span></div></div><div class=col-sm-12 ng-show="result.length == 0"><div class="wrapper-xs text-center"><img ng-src="{{\'asset/img/user_empty.png\' | resource}}"><p class=m-t-sm>没有搜索到用户</p></div></div><div class="col-sm-12 permission-user-part" ng-show=loading><div class="wrapper-xl text-center"><img ng-src="{{\'asset/img/loading.gif\' | resource}}"><p class=m-t-sm>正在加载</p></div></div></div><div class="wrapper-sm b-t text-center" ng-hide=!selected><div ng-show="selected.id != user.id"><div class=inline style="line-height: 30px">移交给：</div><img ng-src="{{selected.avatar | resource}}" class=img-circle style="height:24px;margin-top: -5px" alt=...><div class=inline style="line-height: 30px">{{selected.name}}</div></div><div ng-show="selected.id == user.id"><div class="inline text-danger" style="line-height: 30px">不能移交给自己</div></div></div></div><div class=modal-footer><button type=button class="btn btn-primary" ng-click=ok() style="margin-left: 5px" ng-disabled="!selected || saving"><span ng-show=!saving>移交</span> <span ng-show=saving>正在移交</span></button> <button type=button class="btn btn-default" ng-click=close()>取消</button></div></div>'),e.put("asset/tpl/dashboard/security/activity.html",'<div ng-controller=ActivityCtrl class=app-ctrl style="padding-top: 94px;padding-bottom: 42px"><div class="bg-light b-b app-title-fixed"><div class="col-sm-12 wrapper-sm col-xs-12 b-b"><span class=text-md><i class="glyphicon glyphicon-list-alt"></i> 操作日志</span></div><div class="col-sm-12 wrapper-sm lter col-xs-12"><iframe class=hidden name=exportIframe></iframe><form id=conditionForm class="form-inline text-xs" target=exportIframe action=/activity/export><div class="form-group m-r-xs"><label for="time  ">时间：</label><input name=start class="form-control input-sm" ng-click="startOpended = true" date-format=YYYY-MM-DD ng-model=condition.start datepicker-popup=yyyy-MM-dd is-open=startOpended style=width:100px datepicker-options="{formatYear: \'yyyy\',class:\'datepicker\',showWeeks:false}" close-text=关闭 current-text=今天 clear-text=清除> - <input name=end class="form-control input-sm" date-format=YYYY-MM-DD ng-click="endOpened = true" ng-model=condition.end datepicker-popup=yyyy-MM-dd is-open=endOpened style=width:100px datepicker-options="{formatYear: \'yyyy\',class:\'datepicker\',showWeeks:false}" close-text=关闭 current-text=今天 clear-text=清除></div><div class="form-group text-xs m-r-xs"><label for="name ">文件名称：</label><input name=fileName style=width:120px class="form-control input-sm" id=name ng-model=condition.fileName></div><div class="form-group m-r-xs text-xs"><label for="operator  ">操作人：</label><input name=operator style=width:120px class="form-control input-sm" id=operator ng-model=condition.operator></div><div class="form-group m-r-xs text-xs"><label for="operation ">操作类型：</label><select type=text name=operation class="form-control input-sm" id=operation ng-model=condition.operation><option value="">所有</option><option value=upload>上传</option><option value=download>下载</option><option value=create>创建</option><option value=move>移动</option><option value=copy>复制</option><option value=rename>重命名</option><option value=remove>删除</option><option value=delete>彻底删除</option><option value=revert>恢复</option><option value=deleteVersion>删除版本</option></select></div><button type=button class="btn btn-sm btn-default" ng-click=reload()><i class="glyphicon glyphicon-search"></i> 搜索</button> <button type=button class="btn btn-sm btn-default" onclick="$(\'#conditionForm\').submit();"><i class="glyphicon glyphicon-export"></i> 导出</button></form></div></div><div class="app-inner bg-light lter" ng-show=!error><div class="table-responsive h-full" ng-show="result.total > 0 && !loading"><table class="table table-hover b-b" style="table-layout: fixed"><thead><tr><th width=10%>操作人</th><th width=15%>操作时间</th><th width=10%>操作类型</th><th width=25%>操作对象</th><th width=40%>描述</th></tr></thead><tbody><tr ng-repeat="activity in result.rows" valign=middle><td>{{activity.operator}}</td><td>{{activity.operateDate}}</td><td>{{activity.operation | translate:\'activity\'}}</td><td style="word-break: break-all"><a class=text-u-l href=/index/{{activity.mount}}/{{activity.parent}} target=_blank>{{activity.target.split(":")[1]}}</a></td><td ng-switch=activity.operation style="word-break: break-all"><div ng-switch-when=rename><span>更改前：{{activity.originalName}}</span><br><span>更改后：{{activity.currentName}}</span></div><div ng-switch-when=copy><span>原路径：{{activity.originalPath}}</span><br><span>现路径：{{activity.currentPath}}</span></div><div ng-switch-when=move><span>原路径：{{activity.originalPath}}</span><br><span>现路径：{{activity.currentPath}}</span></div><div ng-switch-default>{{activity.currentPath}}</div></td></tr></tbody></table></div><div class="wrapper-xl text-center" ng-show=loading><img ng-src="{{\'asset/img/loading.gif\' | resource}}"><p class=m-t-sm>正在加载</p></div><div class="wrapper-xl text-center" ng-show="result.total == 0 && !loading"><img ng-src="{{\'asset/img/no_result.png\' | resource}}"><p class=m-t-md>没有查找到数据</p></div></div><div class="pos-abt w-full b-t" style=bottom:0px ng-show="!error && result.total > 0 && !loading"><div class="col-sm-6 wrapper-xs"><button class="btn btn-sm btn-link" ng-click=loadPage(1) ng-disabled="pagination.page == 1"><i class="fa fa-fast-backward"></i></button> <button class="btn btn-sm btn-link" ng-click="loadPage(pagination.page - 1)" ng-disabled="pagination.page == 1"><i class="fa fa-backward"></i></button> <input class="inline form-control input-sm" style="width: 30px" ng-model-options="{ updateOn: \'blur\' }" ng-change=onPageChange(); ng-model=pagination.page> / <span>{{pagination.pages}}</span> <button class="btn btn-sm btn-link" ng-click="loadPage(pagination.page + 1)" ng-disabled="pagination.page == pagination.pages"><i class="fa fa-forward"></i></button> <button class="btn btn-sm btn-link" ng-click=loadPage(pagination.pages) ng-disabled="pagination.page == pagination.pages"><i class="fa fa-fast-forward"></i></button></div><div class="col-sm-6 wrapper-xs text-right"><div style="line-height: 30px">共{{result.total}}条数据，每页显示<select class="form-control input-sm inline" style=width:65px ng-change=reload() ng-model=pagination.size><option value=20>20</option><option value=50>50</option><option value=100>100</option><option value=200>200</option></select>条</div></div><div class=clearfix></div></div><div class="wrapper-xl text-center" ng-show=error><img ng-src="{{\'asset/img/error.png\' | resource}}"><p class=m-t-md>加载失败：{{error}}</p></div></div>'),e.put("asset/tpl/dashboard/security/login_log.html",'<div ng-controller=LoginLogCtrl class=app-ctrl style="padding-top: 94px;padding-bottom: 42px"><div class="bg-light b-b app-title-fixed"><div class="col-sm-12 wrapper-sm col-xs-12 b-b"><span class=text-md><i class="glyphicon glyphicon-list-alt"></i> 登录日志</span></div><div class="col-sm-12 wrapper-sm lter col-xs-12"><iframe class=hidden name=exportIframe></iframe><form id=conditionForm class="form-inline text-xs" target=exportIframe action=/login/log/export><div class="form-group m-r-xs"><label for="time  ">时间：</label><input name=start class="form-control input-sm" ng-click="startOpended = true" date-format=YYYY-MM-DD ng-model=condition.start datepicker-popup=yyyy-MM-dd is-open=startOpended style=width:100px datepicker-options="{formatYear: \'yyyy\',class:\'datepicker\',showWeeks:false}" close-text=关闭 current-text=今天 clear-text=清除> - <input name=end class="form-control input-sm" date-format=YYYY-MM-DD ng-click="endOpened = true" ng-model=condition.end datepicker-popup=yyyy-MM-dd is-open=endOpened style=width:100px datepicker-options="{formatYear: \'yyyy\',class:\'datepicker\',showWeeks:false}" close-text=关闭 current-text=今天 clear-text=清除></div><div class="form-group m-r-xs text-xs"><label for="operator  ">姓名：</label><input name=name style=width:120px class="form-control input-sm" id=operator ng-model=condition.name></div><div class="form-group m-r-xs text-xs"><label for="operator  ">用户名：</label><input name=username style=width:120px class="form-control input-sm" id=operator ng-model=condition.username></div><button type=button class="btn btn-sm btn-default" ng-click=reload()><i class="glyphicon glyphicon-search"></i> 搜索</button> <button type=button class="btn btn-sm btn-default" onclick="$(\'#conditionForm\').submit();"><i class="glyphicon glyphicon-export"></i> 导出</button></form></div></div><div class="app-inner bg-light lter" ng-show=!error><div class="table-responsive h-full" ng-show="result.total > 0 && !loading"><table class="table table-hover b-b"><thead><tr><th width=20%>用户名</th><th width=20%>姓名</th><th width=15%>登录时间</th><th width=15%>登录IP</th><th width=15%>登录地点</th><th width=15%>客户端</th></tr></thead><tbody><tr ng-repeat="log in result.rows" valign=middle><td>{{log.username}}</td><td>{{log.name}}</td><td>{{log.loginDate}}</td><td>{{log.loginIP}}</td><td>{{log.position}}</td><td>{{log.client}}</td></tr></tbody></table></div><div class="wrapper-xl text-center" ng-show=loading><img ng-src="{{\'asset/img/loading.gif\' | resource}}"><p class=m-t-sm>正在加载</p></div><div class="wrapper-xl text-center" ng-show="result.total == 0 && !loading"><img ng-src="{{\'asset/img/no_result.png\' | resource}}"><p class=m-t-md>没有查找到数据</p></div></div><div class="pos-abt w-full b-t" style=bottom:0px ng-show="!error && result.total > 0 && !loading"><div class="col-sm-6 wrapper-xs"><button class="btn btn-sm btn-link" ng-click=loadPage(1) ng-disabled="pagination.page == 1"><i class="fa fa-fast-backward"></i></button> <button class="btn btn-sm btn-link" ng-click="loadPage(pagination.page - 1)" ng-disabled="pagination.page == 1"><i class="fa fa-backward"></i></button> <input class="inline form-control input-sm" style="width: 30px" ng-model-options="{ updateOn: \'blur\' }" ng-change=onPageChange(); ng-model=pagination.page> / <span>{{pagination.pages}}</span> <button class="btn btn-sm btn-link" ng-click="loadPage(pagination.page + 1)" ng-disabled="pagination.page == pagination.pages"><i class="fa fa-forward"></i></button> <button class="btn btn-sm btn-link" ng-click=loadPage(pagination.pages) ng-disabled="pagination.page == pagination.pages"><i class="fa fa-fast-forward"></i></button></div><div class="col-sm-6 wrapper-xs text-right"><div style="line-height: 30px">共{{result.total}}条数据，每页显示<select class="form-control input-sm inline" style=width:65px ng-change=reload() ng-model=pagination.size><option value=20>20</option><option value=50>50</option><option value=100>100</option><option value=200>200</option></select>条</div></div><div class=clearfix></div></div><div class="wrapper-xl text-center" ng-show=error><img ng-src="{{\'asset/img/error.png\' | resource}}"><p class=m-t-md>加载失败：{{error}}</p></div></div>'),e.put("asset/tpl/dashboard/security/permission_form.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>权限配置- {{operation}}</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=permissionConfigForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-2 control-label">名称</label><div class=col-sm-10><input name=name ng-model=permission.name required class=form-control></div></div><div class=form-group><label class="col-sm-2 control-label">权限</label><div class=col-sm-10><label class="checkbox-inline i-checks col-sm-12 m-l-none"><input type=checkbox name=isCheckAll ng-model=isCheckAll ng-change=checkAll(isCheckAll);><i></i> 全选</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.view><i></i> 查看/预览</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.upload><i></i> 上传</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.download><i></i> 下载</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.create><i></i> 创建文件夹</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.move><i></i> 移动</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.copy><i></i> 复制</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.lock><i></i> 锁定/解锁</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.rename><i></i> 重命名</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.remove><i></i> 删除</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.revert><i></i> 恢复</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.share><i></i> 分享</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.tag><i></i> 设置标签</label><label class="checkbox-inline i-checks col-sm-4 m-l-none"><input type=checkbox name=authorities ng-model=permissions.review><i></i> 评论</label></div></div><div class=form-group><label class="col-sm-2 control-label">描述</label><div class=col-sm-10><textarea rows=3 name=extensions ng-model=permission.description class=form-control></textarea></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=save() ng-disabled="(permissionConfigForm.$invalid || !permissionConfigForm.$dirty || saving)"><span ng-show=saving>正在保存</span> <span ng-show=!saving>保存</span></button> <button type=button class="btn btn-default" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/security/permission.html",'<div ng-controller=PermissionConfigCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-5"><h1 class="m-n font-thin h3" style="line-height: 34px">权限配置</h1></div><div class="col-sm-6 col-xs-7 text-right"><button class="btn btn-primary" ng-click=add()>新建权限</button></div></div></div><div class="app-inner bg-light lter"><div class="table-responsive h-full" ng-show="permissions.length > 0 && !loading"><table class="table table-hover b-b"><thead><tr><th width=30%>名称</th><th width=50%>描述</th><th width=20%>操作</th></tr></thead><tbody><tr ng-repeat="permission in permissions | filter:{name:condition.name,description:condition.description}" valign=middle><td>{{permission.name}}</td><td>{{permission.description}}</td><td><i class="fa fa-edit hover text-md m-r-xs" ng-click=edit(permission,$event); tooltip=编辑></i> <i class="fa fa-trash hover text-md m-r-xs" ng-click=remove(permission,$event); tooltip=删除></i></td></tr></tbody></table></div><div class="wrapper-xl text-center" ng-show=loading><img ng-src="{{\'asset/img/loading.gif\' | resource}}"><p class=m-t-sm>正在加载</p></div><div class="wrapper-xl text-center" ng-show="(permissions.length == 0 || !permissions) && !loading"><img ng-src="{{\'asset/img/empty.png\' | resource}}"><p class=m-t-md>目前还没有配置权限</p><button class="btn btn-primary" onclick=add()><i class="glyphicon glyphicon-plus"></i>新建权限</button></div></div><div class="wrapper-xl text-center" ng-show=error><img ng-src="{{\'asset/img/error.png\' | resource}}"><p class=m-t-md>加载权限失败：{{error}}</p></div></div>'),e.put("asset/tpl/dashboard/security/settings.html",'<div ng-controller=SecuritySettingCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-6"><h1 class="m-n font-thin h3">安全设置</h1></div><div class="col-sm-6 col-xs-6" style="text-align: right"><button class="btn btn-primary" ng-disabled="securitySettingForm.$invalid || !securitySettingForm.$dirty" ng-click=save()>保存</button> <button class="btn btn-minor" ng-disabled=!securitySettingForm.$dirty ng-click=reset()>重置</button></div></div></div><div class="wrapper-md app-inner"><form name=securitySettingForm class="form-horizontal form-property"><div class="panel panel-default"><div class="panel-heading font-bold">登录设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">登录失败次数限制</label><div class=col-sm-7><input type=number ng-model=setting.loginFailLimit min=3 class=form-control style="width: 100px"> <span class="help-block m-b-none">登录失败次数超过设置次数则禁止登录并锁定账户，用户登录成功后清除失败次数</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">是否需要输入验证码</label><div class=col-sm-7><label class="i-switch bg-primary m-t-xs m-r"><input type=checkbox ng-checked=setting.showVerificationCode ng-model=setting.showVerificationCode> <i></i></label></div></div><div class="line line-dashed b-b line-lg" ng-show=setting.showVerificationCode></div><div class="form-group fade-in" ng-show=setting.showVerificationCode><label class="col-sm-5 control-label">只在异常登录情况下输入</label><div class=col-sm-7><label class="i-switch bg-primary m-t-xs m-r"><input type=checkbox ng-checked=setting.showVerificationCodeOnError ng-model=setting.showVerificationCodeOnError> <i></i></label></div></div><div class="line line-dashed b-b line-lg" ng-show=setting.showVerificationCode></div><div class="form-group fade-in" ng-show=setting.showVerificationCode><label class="col-sm-5 control-label">验证码长度</label><div class=col-sm-7><input type=number min=4 max=8 class=form-control required style="width: 100px" ng-model=setting.verificationCodeLength> <span class="help-block m-b-none">生成验证码长度，最短长度4位，最长为8位</span></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">密码策略</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">默认密码</label><div class=col-sm-7><input ng-minlength=4 maxlength=20 class=form-control style="width: 150px" ng-model=setting.defaultPassword> <span class="help-block m-b-none">控制台添加用户默认的密码，用户第一次登录需要修改密码，最短4位，最长20位</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">密码长度</label><div class=col-sm-7><input type=number min=4 class=form-control style="width: 100px" ng-model=setting.minLengthOfPassword> <span class="help-block m-b-none">限制用户密码的最短长度，最短长度4位</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">密码强度</label><div class=col-sm-7><label class="checkbox-inline i-checks"><input type=radio name=passwordStrength value=1 ng-checked="setting.passwordStrength == 1" ng-model=setting.passwordStrength><i></i> 弱</label><label class="checkbox-inline i-checks"><input type=radio name=passwordStrength value=2 ng-checked="setting.passwordStrength == 2" ng-model=setting.passwordStrength><i></i> 普通</label><label class="checkbox-inline i-checks"><input type=radio name=passwordStrength value=3 ng-checked="setting.passwordStrength == 3" ng-model=setting.passwordStrength><i></i> 中等</label><label class="checkbox-inline i-checks"><input type=radio name=passwordStrength value=4 ng-checked="setting.passwordStrength == 4" ng-model=setting.passwordStrength><i></i> 强</label><div ng-show="setting.passwordStrength ==1" class="alert alert-info" style="margin-bottom: 0px; margin-top: 10px; width: 400px" role=alert>任意密码，只要求限制密码长度</div><div ng-show="setting.passwordStrength == 2" class="alert alert-info" style="margin-bottom: 0px; margin-top: 10px; width: 400px" role=alert>密码必须为数字和字母组合</div><div ng-show="setting.passwordStrength == 3" class="alert alert-info" style="margin-bottom: 0px; margin-top: 10px; width: 400px" role=alert>密码必须为数字和字母组合，且必须含有大小写字母</div><div ng-show="setting.passwordStrength == 4" class="alert alert-info" style="margin-bottom: 0px; margin-top: 10px; width: 400px" role=alert>密码必须为数字和字母组合，且必须含有大小写字母和特殊字符</div></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">上传设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">文件大小限制</label><div class=col-sm-7><input type=number ng-model=setting.maxUploadFileSize min=0 class=form-control style="width: 100px; display: inline"> MB<div ng-show="(setting.maxUploadFileSize > 2048)" class="alert alert-danger" style="margin-bottom: 0px; margin-top: 5px; width: 200px" role=alert>最大限制不能超过2G</div></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">允许上传的文件类型</label><div class=col-sm-7><input class=form-control style="width: 200px" ng-model=setting.includeExtensions> <span class="help-block m-b-none">填写文件后缀，多个后缀使用“;”进行连接，例如：doc;docx;xls</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">禁止上传的文件类型</label><div class=col-sm-7><input class=form-control style="width: 200px" ng-model=setting.excludeExtensions> <span class="help-block m-b-none">填写文件后缀，多个后缀使用“;”进行连接，例如:exe;bat</span></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">文件设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">开启水印</label><div class=col-sm-7><label class="i-switch bg-primary m-t-xs m-r"><input type=checkbox ng-checked=setting.enableWatermark ng-model=setting.enableWatermark> <i></i></label></div></div><div class="line line-dashed b-b line-lg hidden"></div><div class="form-group hidden"><label class="col-sm-5 control-label">水印内容</label><div class=col-sm-7><label class="checkbox-inline i-checks"><input type=checkbox ng-checked=watermarkProperties.name ng-model=watermarkProperties.name><i></i> 姓名</label><label class="checkbox-inline i-checks"><input type=checkbox ng-checked=watermarkProperties.dept ng-model=watermarkProperties.dept><i></i> 部门</label><label class="checkbox-inline i-checks"><input type=checkbox ng-checked=watermarkProperties.date ng-model=watermarkProperties.date><i></i> 日期</label><label class="checkbox-inline i-checks"><input type=checkbox ng-checked=watermarkProperties.time ng-model=watermarkProperties.time><i></i> 时间</label><label class="checkbox-inline i-checks"><input type=checkbox ng-checked=watermarkProperties.fileName ng-model=watermarkProperties.fileName><i></i> 文件名称</label></div></div></div></div></form></div></div>'),e.put("asset/tpl/dashboard/storage/oss_form.html",'<div class=m-c><div class=modal-header><h4 class=modal-title>阿里云存储 - {{operation}}</h4></div><div class="modal-body wrapper-lg"><div class=row><div class=col-sm-12><form name=ossStorageForm class="form-horizontal form-validation"><div class=form-group><label class="col-sm-3 control-label">名称</label><div class=col-sm-9><input name=name ng-model=storage.name required class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">AccessKeyId</label><div class=col-sm-9><input name=accessKeyId ng-model=storage.accessKeyId required ng-minlength=10 class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">AccessKeySecret</label><div class=col-sm-9><input name=accessKeySecret ng-model=storage.accessKeySecret required ng-minlength=10 class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">Bucket</label><div class=col-sm-9><input name=bucketName ng-model=storage.bucketName required class=form-control></div></div><div class=form-group><label class="col-sm-3 control-label">节点</label><div class=col-sm-9><select name=endpoint ng-model=storage.endpoint required class=form-control><option value=oss-cn-hangzhou.aliyuncs.com>华东 1</option><option value=oss-cn-shanghai.aliyuncs.com>华东 2</option><option value=oss-cn-qingdao.aliyuncs.com>华北 1</option><option value=oss-cn-beijing.aliyuncs.com>华北 2</option><option value=oss-cn-zhangjiakou.aliyuncs.com>华北 2</option><option value=oss-cn-shenzhen.aliyuncs.com>华南 1</option><option value=oss-cn-hongkong.aliyuncs.com>香港</option></select></div></div><div class=form-group ng-show=result><div class=col-sm-12><div class="alert alert-danger m-b-none" role=alert>{{result.message}}</div></div></div><div class="form-group m-b-none" ng-show=testResult><div class=col-sm-12><div class="alert m-b-none" ng-class="{\'alert-danger\':!testResult.success,\'alert-success\':testResult.success}" role=alert>{{testResult.message}}</div></div></div></form></div></div></div><div class=modal-footer style="text-align: right"><button type=button class="btn btn-primary" ng-click=test() ng-disabled="testStatus.testing ">{{testStatus.testText}}</button> <button type=button class="btn btn-primary" ng-click=save() ng-disabled="(ossStorageForm.$invalid || !ossStorageForm.$dirty)">保存</button> <button type=button class="btn btn-minor" ng-click=cancel()>取消</button></div></div>'),e.put("asset/tpl/dashboard/storage/settings.html",'<div ng-controller=StorageSettingCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-6"><h1 class="m-n font-thin h3">存储设置</h1></div><div class="col-sm-6 col-xs-6" style="text-align: right"><button class="btn btn-primary" ng-disabled="storageSettingForm.$invalid || !storageSettingForm.$dirty" ng-click=save()>保存</button> <button class="btn btn-minor" ng-disabled=!storageSettingForm.$dirty ng-click=reset()>重置</button></div></div></div><div class="wrapper-md app-inner"><form name=storageSettingForm class="form-horizontal form-property form-validation"><div class="panel panel-default"><div class="panel-heading font-bold">存储设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">数据存储位置</label><div class=col-sm-7><select ng-model=setting.fileStorageType ng-change=fileStorageChange() ng-options="storage.id as storage.name for storage in storages" required class="form-control inline w-sm"></select><input ng-change=fileStorageChange() name=fileStoragePath required ng-model=setting.fileStoragePath class="form-control m-l-xs inline w-xl"> <span class="help-block m-b-none">用于存储上传的文件，如果需要更改的话请先进行数据迁移</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">资源存储位置</label><div class=col-sm-7><select ng-model=setting.resourceStorageType ng-change=resourceStorageChange() ng-options="storage.id as storage.name for storage in storages" required class="form-control inline w-sm"></select><input ng-change=resourceStorageChange() name=resourceStoragePath required ng-model=setting.resourceStoragePath class="form-control m-l-xs inline w-xl"> <span class="help-block m-b-none">用于存储系统上传的图片等数据，如果需要更改的话请先进行数据迁移</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">临时文件存储位置</label><div class=col-sm-7><input class=form-control name=temporaryStorage required ng-model=setting.temporaryStorage> <span class="help-block m-b-none">用于存储用户上传的临时文件的本地目录</span></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">数据访问</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">静态文件服务器</label><div class=col-sm-7><input class=form-control name=resourceServceUrl ng-model=setting.staticResourceServerUrl> <span class="help-block m-b-none">可将数据与应用程序进行分离访问</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">资源访问服务器</label><div class=col-sm-7><input class=form-control name=resourceServceUrl required ng-model=setting.resourceServceUrl> <span class="help-block m-b-none">可将数据与应用程序进行分离访问</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">Office预览服务器</label><div class=col-sm-7><input class=form-control name=officePreviewServerUrl required ng-model=setting.officePreviewServerUrl></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">配额设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">用户默认配额</label><div class=col-sm-7><input type=number ng-model=setting.userQuato min=0 class="form-control text-il" style="width:100px;display: inline"> GB <span class="help-block m-b-none">用户默认可使用的空间配额，如果不设置则没有空间限制</span></div><div class="line line-dashed b-b line-lg"></div><label class="col-sm-5 control-label">默认分片大小</label><div class=col-sm-7><input type=number ng-model=setting.partSize min=5 class="form-control text-il" style="width:100px;display: inline"> MB <span class="help-block m-b-none">断点续传的分片大小</span></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">版本和回收站设置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">历史版本数量</label><div class=col-sm-7><input type=number ng-model=setting.numberOfHistories min=1 class="form-control text-il" style=width:100px> <span class="help-block m-b-none">历史版本的最大控制数量，如果超过的话 则将最老版本的数据清除，如果不设置则保存所有版本</span></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">回收站保存天数</label><div class=col-sm-7><input type=number ng-model=setting.daysOfRecycle min=0 class="form-control text-il" style="width:100px;display: inline">&nbsp;天 <span class="help-block m-b-none">回收站保存数据的天数，如果保存时间到期则自动清除数据，如果不设置则永久保留</span></div></div></div></div></form></div></div>'),e.put("asset/tpl/dashboard/storage/storages.html",'<div ng-controller=StorageConfigCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-5"><h1 class="m-n font-thin h3">存储配置</h1></div><div class="col-sm-6 col-xs-7" style="text-align: right"><div class=btn-group dropdown is-open=status.isopen><button type=button class="btn btn-primary" dropdown-toggle>添加&nbsp;<span class=caret></span></button><ul class=dropdown-menu role=menu><li><a href ng-click=addOSS();>阿里云存储</a></li><li><a href>FTP存储</a></li><li><a href>HDFS存储</a></li></ul></div><button class="btn btn-primary" ng-disabled=!selected ng-click=edit()>编辑</button> <button class="btn btn-primary" ng-disabled=!selected ng-click=removeStorage()>删除</button></div></div></div><div class="wrapper-md app-inner"><toaster-container toaster-options="{\'position-class\': \'toast-top-right\', \'close-button\':true}"></toaster-container><div class=row><div class=col-sm-12><h4 class="m-n font-thin">存储列表</h4></div><div class=col-sm-12><p class=m-t ng-show=status.loading>正在加载存储列表信息....</p><p class=m-t ng-show="!status.loading && status.loadError">{{status.loadErrorText}}</p><ul class=storage-list><li class=storage ng-class="{\'storage-selected\':storage.selected === true}" ng-repeat="storage in storages" ng-click=setSelected(storage)><img class=storage-icon ng-src={{storage.icon}}><div class=storage-name>{{storage.name}}</div></li></ul></div></div></div></div>'),e.put("asset/tpl/dashboard/system/cluster.html",'<div ng-controller=ClusterSettingCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-6"><h1 class="m-n font-thin h3" style="line-height: 34px">集群设置</h1></div><div class="col-sm-6 col-xs-6" style="text-align: right"><button class="btn btn-primary" ng-disabled="settingForm.$invalid || !settingForm.$dirty" ng-click=save()>保存</button> <button class="btn btn-minor" ng-disabled=!settingForm.$dirty ng-click=reset()>重置</button></div></div></div><div class="wrapper-md app-inner"><form name=settingForm class="form-horizontal form-property form-validation"><div class="panel panel-default"><div class="panel-heading font-bold">域名配置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">域名</label><div class=col-sm-7><input ng-model=setting.domain class=form-control style="width: 60%"></div></div></div></div><div class="panel panel-default"><div class="panel-heading font-bold">组件配置</div><div class=panel-body><div class=form-group><label class="col-sm-5 control-label">应用服务器</label><div class=col-sm-7><input ng-model=setting.appServerUrl class=form-control style="width: 60%"></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">登录服务器</label><div class=col-sm-7><input ng-model=setting.loginServerUrl class=form-control style="width: 60%"></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">上传服务器</label><div class=col-sm-7><input ng-model=setting.uploadServerUrl class=form-control style="width: 60%"></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">下载服务器</label><div class=col-sm-7><input ng-model=setting.downloadServerUrl class=form-control style="width: 60%"></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">预览服务器</label><div class=col-sm-7><input ng-model=setting.previewServerUrl class=form-control style="width: 60%"></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">搜索服务器</label><div class=col-sm-7><input ng-model=setting.searchServerUrl class=form-control style="width: 60%"></div></div></div></div></form></div></div>'),e.put("asset/tpl/dashboard/system/mail.html",'<div ng-controller=MailSettingCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-6"><h1 class="m-n font-thin h3" style="line-height: 34px">邮件服务器</h1></div><div class="col-sm-6 col-xs-6" style="text-align: right"><button class="btn btn-primary" ng-disabled="settingForm.$invalid || !settingForm.$dirty || (setting.enable && !setting.ssoServerUrl)" ng-click=save()>保存</button> <button class="btn btn-minor" ng-disabled=!settingForm.$dirty ng-click=reset()>重置</button></div></div></div><div class=wrapper-md><div class="panel panel-default"><div class="panel-heading font-bold">配置</div><div class=panel-body><form name=settingForm class="form-horizontal form-property"><div class=form-group><label class="col-sm-5 control-label">邮件服务器</label><div class=col-sm-7><input ng-model=setting.host required class=form-control></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">账号</label><div class=col-sm-7><input type=email ng-model=setting.username required class=form-control></div></div><div class="line line-dashed b-b line-lg"></div><div class=form-group><label class="col-sm-5 control-label">密码</label><div class=col-sm-7><input ng-model=setting.password required class=form-control></div></div></form></div></div></div></div>'),e.put("asset/tpl/dashboard/system/settings.html",'<div class="bg-light lter b-b wrapper-md"><h1 class="m-n font-thin h3">系统设置</h1></div><div class=wrapper-md ng-controller=SettingsCtrl><div class="panel panel-default"><div class="panel-heading font-bold">邮件服务器</div><div class=panel-body><form class="form-horizontal form-property"><div class=form-group><label class="col-sm-5 control-label">开启邮件通知</label><div class=col-sm-7><label class="i-switch m-t-xs m-r"><input type=checkbox ng-checked=loginSetting.enable ng-model=setting.validateCode> <i></i></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">邮件服务器</label><div class=col-sm-7><input ng-model=settings.host class=form-control style=width:40%></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">用户名</label><div class=col-sm-7><input ng-model=settings.username class=form-control style=width:40%></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">密码</label><div class=col-sm-7><input type=password ng-model=settings.password class=form-control style=width:40%></div></div></form></div></div><div class="panel panel-default"><div class="panel-heading font-bold">单点登录</div><div class=panel-body><form class="form-horizontal form-property"><div class=form-group><label class="col-sm-5 control-label">是否启动单点登录</label><div class=col-sm-7><label class="i-switch m-t-xs m-r"><input type=checkbox ng-checked=loginSetting.validateCode ng-model=setting.validateCode> <i></i></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class=form-group><label class="col-sm-5 control-label">单点登录服务器</label><div class=col-sm-7><input ng-model=settings.appName class=form-control></div></div></form></div></div></div>'),e.put("asset/tpl/dashboard/system/sso.html",'<div ng-controller=SsoSettingCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-6"><h1 class="m-n font-thin h3" style="line-height: 34px">单点登录</h1></div><div class="col-sm-6 col-xs-6" style="text-align: right"><button class="btn btn-primary" ng-disabled="settingForm.$invalid || !settingForm.$dirty || (setting.enable && !setting.ssoServerUrl)" ng-click=save()>保存</button> <button class="btn btn-minor" ng-disabled=!settingForm.$dirty ng-click=reset()>重置</button></div></div></div><div class="wrapper-md app-inner"><div class="panel panel-default"><div class="panel-heading font-bold">配置</div><div class=panel-body><form name=settingForm class="form-horizontal form-property"><div class=form-group><label class="col-sm-5 control-label">是否启用</label><div class=col-sm-7><label class="i-switch m-t-xs m-r"><input type=checkbox ng-checked=setting.enable ng-model=setting.enable> <i></i></label></div></div><div class="line line-dashed b-b line-lg" ng-show=setting.enable></div><div class=form-group ng-show=setting.enable><label class="col-sm-5 control-label">单点登录服务器</label><div class=col-sm-7><input ng-model=setting.casServerUrl class=form-control></div></div></form></div></div></div></div>'),e.put("asset/tpl/dashboard/system/task.html",'<div ng-controller=TaskManagerCtrl class=app-ctrl><div class="bg-light lter b-b wrapper-md app-title-fixed"><div class=row><div class="col-sm-6 col-xs-5"><h1 class="m-n font-thin h3" style="line-height: 34px">任务管理</h1></div><div class="col-sm-6 col-xs-7" style="text-align: right"><button class="btn btn-primary" ng-disabled="status.syncing == true" ng-click=sync()>{{status.syncText}}</button> <button class="btn btn-minor" ng-click=load()>刷新</button></div></div></div><div class="wrapper-sm app-inner bg-light lter"><div class="table-responsive h-full" ng-show=!status.loading><table class="table table-hover b-b"><thead><tr><th ng-click="title=\'name\';desc=!desc" width=20%>任务名称 <i ng-show="title == \'name\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th ng-click="title=\'cronExpression\';desc=!desc" width=20%>执行时间 <i ng-show="title == \'cronExpression\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th ng-click="title=\'nextExecuteDate\';desc=!desc" width=20%>下次运行时间 <i ng-show="title == \'nextExecuteDate\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th ng-click="title=\'status\';desc=!desc" width=10%>状态 <i ng-show="title == \'status\'" ng-class="{\'fa-caret-up\' : desc,\'fa-caret-down\':!desc}" class=fa></i></th><th width=10%>是否启用</th><th width=20%>操作</th></tr></thead><tbody><tr><th><input class="input-sm form-control" placeholder="" ng-model=condition.name></th><th><input class="input-sm form-control" placeholder="" ng-model=condition.cronExpression></th><th><div class=input-group><input class="form-control input-sm" datepicker-popup=yyyy-MM-dd ng-model=condition.nextExecuteDate is-open=opened datepicker-options="{formatYear: \'yyyy\',class:\'datepicker\'}" ng-required=true close-text=关闭 current-text=今天 clear-text=清除> <span class=input-group-btn><button type=button class="btn btn-sm btn-default" ng-click=open($event)><i class="glyphicon glyphicon-calendar"></i></button></span></div></th><th><select class="input-sm form-control" ng-model=condition.status><option></option><option value=0>执行完成</option><option value=1>正在执行</option><option value=2>执行异常</option><option value=3>准备执行</option></select></th><th><select class="input-sm form-control" ng-model=condition.enable><option></option><option value=0>是</option><option value=1>否</option></select></th><th></th></tr><tr ng-repeat="task in tasks | filter:{name:condition.name,cronExpression:condition.cronExpression,nextExecuteDate:condition.nextExecuteDate,status:condition.status,enable:condition.enable}  | orderBy: title : desc" valign=middle><td style="padding-top: 12px">{{task.name}}</td><td style="padding-top: 12px">{{task.cronExpression}}</td><td style="padding-top: 12px">{{task.nextExecuteDate}}</td><td style="padding-top: 12px">{{task.status | translate:\'system.task.status\'}}</td><td style="padding-top: 12px">{{task.enable | translate:\'common.YN\'}}</td><td><button class="btn btn-default btn-sm" ng-show="task.enable == false">启用</button> <button class="btn btn-default btn-sm" ng-show="task.enable == true">禁用</button> <button class="btn btn-default btn-sm" ng-show="task.status != 1">执行</button></td></tr></tbody></table></div></div></div>')}]);